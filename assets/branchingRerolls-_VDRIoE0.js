import{A as T,S as K}from"./shop-GGQk6rn8.js";import{G as L}from"./GhostBlueprints-hGVhIEm9.js";import{u as v,a as C,U as E}from"./UnlockSelect-begyReVL.js";import{h as F,F as V,u as e,a as G,p as M,g as H}from"./main-spyJSKMz.js";import{u as _}from"./usePersistentState-IjLRtqGq.js";import{U as j}from"./unlocks-fGSP_DLg.js";import"./prng-1rWzft78.js";const q=[...T];function z(t,r,s){const o=r.toLowerCase();return q.filter(function(a){return!t.some(u=>u.ID===a.ID)&&a.Name.toLowerCase().includes(o)&&(!s||a.StapleWhenMissing||a.SellOnlyAsUnique)}).sort((l,a)=>l.Name<a.Name?-1:1)}function W({onSelectionChange:t,label:r,placeholder:s,include:o=!0,appliances:l=[],stapleRelatedOnly:a=!0}){const[u,b]=F(""),I=V(()=>z(l,u,a),[l,u]),{getSelectedItemProps:m,getDropdownProps:N,removeSelectedItem:h}=v({selectedItems:l,onStateChange({selectedItems:i,type:d}){switch(d){case v.stateChangeTypes.SelectedItemKeyDownBackspace:case v.stateChangeTypes.SelectedItemKeyDownDelete:case v.stateChangeTypes.DropdownKeyDownBackspace:case v.stateChangeTypes.FunctionRemoveSelectedItem:t(i??[]);break}}}),{isOpen:c,getToggleButtonProps:p,getLabelProps:w,getMenuProps:k,getInputProps:D,highlightedIndex:y,getItemProps:S,selectedItem:x}=C({items:I,itemToString(i){return i?i.Name:""},defaultHighlightedIndex:-1,selectedItem:null,inputValue:u,stateReducer(i,d){const{changes:n,type:g}=d;switch(g){case C.stateChangeTypes.InputChange:return d.inputValue?{...n,highlightedIndex:0}:{...n,highlightedIndex:-1};case C.stateChangeTypes.InputKeyDownEnter:return{...n,isOpen:!1,highlightedIndex:-1};case C.stateChangeTypes.ItemClick:return{...n,isOpen:!0,highlightedIndex:-1};default:return n}},onStateChange({inputValue:i,type:d,selectedItem:n}){switch(d){case C.stateChangeTypes.InputKeyDownEnter:case C.stateChangeTypes.ItemClick:case C.stateChangeTypes.InputBlur:n&&(t([...l,n]),b(""));break;case C.stateChangeTypes.InputChange:b(i??"");break}}});return e("div",{className:"combo-container",children:[e("div",{className:"",children:[e("label",{className:"",...w(),children:r??"Select desired cards"}),e("div",{className:"",children:[l.map(function(d,n){return e("span",{className:"selected-items"+(o?" include":" exclude"),...m({selectedItem:d,index:n}),children:[d.Name,e("span",{class:"x",onClick:g=>{g.stopPropagation(),h(d)},children:"âœ•"})]},`selected-item-${n}`)}),e("div",{className:"",children:e("input",{placeholder:s??"Card Selection(s)",className:"",...D(N({preventKeyAction:c}))})})]})]}),e("ul",{className:`dropdown ${c&&I.length?"":"hidden"}`,...k(),children:[!1,c&&I.map((i,d)=>e("li",{className:J(y===d&&"bg-blue-300",x===i&&"font-bold","py-2 px-3 shadow-sm flex flex-col"),...S({item:i,index:d}),children:e("span",{children:i.Name})},`${i.ID}${d}`))]})]})}const J=(...t)=>t.filter(r=>r).join(" ");function Q(t){let r="";if(!t.length)r="Spawn: any settings";else{for(let o=0;o<t.length;o++){const l=t[o];let a=o?`Reroll ${o}`:"Spawn";a+=": ",a+="Blueprints "+(l.spawnInside?"Spawn Inside":"Spawn Outside, "+(l.playerInside?"Someone Inside":"All Players Stand Outside")),o&&(a+=`, reroll ${t[o].blueprintCount} blueprints`),r+=a+`
`}r+=`Reroll ${t.length}: any settings`}const s=r.split(`
`);return e("div",{class:"reroll-instructions",onClick:o=>{if(o.detail<2)return;const l=document.createRange();l.selectNodeContents(o.currentTarget);const a=document.getSelection();a==null||a.removeAllRanges(),a==null||a.addRange(l)},children:s.map(o=>e("div",{children:o}))})}const B=T.filter(t=>t.Name==="Booking Desk"||t.Name==="Blueprint Cabinet").sort((t,r)=>t.Name<r.Name?1:-1);function X(t,r){const s=t.at(-1);if(r)switch(((s==null?void 0:s.blueprintCount)??0)%3){case 0:return"I";case 1:return"OI";default:return"OO"}return s!=null&&s.spawnInside?"I":s!=null&&s.playerInside?"OI":"OO"}const Y=[0,3,5,6,9,12],Z=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],ee=({seed:t,day:r,startingConfig:s=[],baseUpgradeChance:o=0,blueprintCount:l=5,searchDepth:a=2,ghostBlueprints:u=2,blueprintCabinets:b=1,solo:I,cards:m=[],appliances:N=[],simpleBPSettings:h=!1})=>{var d;t=t.toLocaleLowerCase().trim();const c={blueprintCount:l+u,spawnInside:!0},p=new K(t,o),w=l===7;let k=[];const D=w?Z:Y;{let n=0;for(const g of D){if(g>r){console.log(`added up to card ${n}: ${m.slice(0,n).map(R=>R.Name).join(", ")}`);break}g===r?(k.push(m[n]),p.handleNewCardSpawnEffects(m[n])):p.addCard(m[n]),n++}}p.OwnedAppliances=[...p.OwnedAppliances,...N];const y=[],S=[];for(let n=-b-1;n<=b;n++){const g={spawnInside:!0,blueprintCount:l+n};n===0&&S.push(g),y.push(g),!h&&(I||y.push({spawnInside:!1,playerInside:!0,blueprintCount:l+n}),y.push({spawnInside:!1,playerInside:!1,blueprintCount:l+n}),n===0&&(S.push({spawnInside:!1,playerInside:!0,blueprintCount:l+n}),S.push({spawnInside:!1,playerInside:!1,blueprintCount:l+n})))}let x=[],i=[s];for(let n=0;n<=a;n++){if(n)for(const f of k)p.handleNewCardRerollEffects(f);let g=[],R=[];for(let f=0;f<i.length;f++){const P={...c};P.blueprintCount=i[f].length?(((d=i[f].at(-1))==null?void 0:d.blueprintCount)??l)+u:l;const A=p.getAppliances([...i[f],P],r).map(O=>O.Name);R.push(e("td",{class:"reroll-cell "+X(i[f],h),colspan:y.length**(a-n),children:[e(L,{bps:A,ghostCount:n===0?0:u}),Q(i[f])]}));const U=s.length+n===0?S:y;for(const O of U){const $=[...i[f],O];g.push($)}}x.push(e("tr",{children:[e("td",{children:n?`Reroll ${n}`:"Spawns"}),R]})),i=g}return e("table",{children:[" ",x," "]})},ne=({onConfigChange:t,config:r})=>{const{seed:s,day:o,blueprintCount:l,solo:a,appliances:u=B,cards:b,searchDepth:I,simpleBPSettings:m=!1}=r,N=c=>{let p={...r};c.target.checked?(p.blueprintCount=7,p.baseUpgradeChance=.25):(p.blueprintCount=5,p.baseUpgradeChance=0),t(p)},h=(c,p)=>{let w={...r};w[c]=p,t(w)};return e("div",{children:[e("div",{children:[e("div",{children:"Run Config:"}),e("label",{for:"solo",children:"Solo:"}),e("input",{type:"checkbox",id:"solo",checked:a,onChange:()=>{h("solo",!a)}}),e("span",{style:"margin:0 20px",children:[e("label",{for:"simpleRerollSettings",children:"Spawn inside only:"}),e("input",{type:"checkbox",id:"simpleRerollSettings",checked:!!m,onChange:()=>{h("simpleBPSettings",!m)}})]}),e("div",{children:[e("label",{for:"searchDepth",children:"Number of Rerolls"})," ",e("input",{id:"searchDepth",type:"number",value:I,onChange:c=>{h("searchDepth",Number(c.target.value))}})]}),e("label",{for:"seed",value:s,children:["Seed:"," "]}),e("input",{type:"text",id:"seed",value:s,onChange:c=>{h("seed",c.target.value)}}),e("label",{for:"setting",children:"Turbo?"}),e("input",{id:"setting",type:"checkbox",checked:l===7,onChange:N})]}),e("div",{children:[e("label",{for:"day",value:o,children:["Prep of Day:"," "]}),e("input",{type:"number",id:"day",value:o+1,onChange:c=>{h("day",Number(c.target.value)-1)}}),e(E,{id:"",label:"Enter all cards in order, including your starting dish:",onSelectionChange:c=>{h("cards",c.cards)},showSelectionMode:!1,cards:b,include:!0,modes:["themes","dishes","customerCards"]}),e(W,{label:"Select owned appliances:",placeholder:"",onSelectionChange:c=>{h("appliances",c)},appliances:u})]})]})},te={seed:"az",day:2,cards:[],initialRerollConfig:[],blueprintCount:5,baseUpgradeChance:0,solo:!1,appliances:B,searchDepth:2,simpleBPSettings:!1},de=()=>{const[t,r]=_(te,"BRANCH_CONFIG"),[s,o]=G();return M(()=>{s.has("cards")&&(r(l=>({...l,seed:s.get("seed")??l.seed,cards:s.get("cards").split(",").map(a=>j.filter(u=>u.Name===a)[0]),blueprintCount:s.get("turbo")?7:5,baseUpgradeChance:s.get("turbo")?.25:0,solo:!!Number(s.get("solo"))})),o(new URLSearchParams,{replace:!0}))},[s]),e(H,{children:[e("div",{children:"Hover over a cell for instructions on how to get those blueprints. Getting the blueprints in grey requires taking extra blueprints out of cabinets"}),e(ne,{onConfigChange:r,config:t}),e(ee,{...t,blueprintCabinets:1}),!1]})};export{de as default};
