import{u as e,q as A,g as P}from"./jsxRuntime.module-lz3Tx-bR.js";import{A as x,S as $}from"./shop-CHrotqkP.js";import{G as K}from"./GhostBlueprints-8npY77LS.js";import{u as N,a as y,U}from"./UnlockSelect-vvD2NlYF.js";import{h as V,F as L}from"./compat.module-aXJm5aLC.js";import{V as F}from"./Version-51ERFU1m.js";import{u as G}from"./usePersistentState-9AkVLkWN.js";import"./prng-1rWzft78.js";import"./unlocks-7WnRp8yW.js";const M=[...x];function q(n,t,d){const o=t.toLowerCase();return M.filter(function(s){return!n.some(u=>u.ID===s.ID)&&s.Name.toLowerCase().includes(o)&&(!d||s.StapleWhenMissing||s.SellOnlyAsUnique)}).sort((l,s)=>l.Name<s.Name?-1:1)}function E({onSelectionChange:n,label:t,placeholder:d,include:o=!0,appliances:l=[],stapleRelatedOnly:s=!0}){const[u,C]=V(""),b=L(()=>q(l,u,s),[l,u]),{getSelectedItemProps:S,getDropdownProps:g,removeSelectedItem:i}=N({selectedItems:l,onStateChange({selectedItems:p,type:a}){switch(a){case N.stateChangeTypes.SelectedItemKeyDownBackspace:case N.stateChangeTypes.SelectedItemKeyDownDelete:case N.stateChangeTypes.DropdownKeyDownBackspace:case N.stateChangeTypes.FunctionRemoveSelectedItem:n(p??[]);break}}}),{isOpen:c,getToggleButtonProps:f,getLabelProps:w,getMenuProps:k,getInputProps:m,highlightedIndex:D,getItemProps:r,selectedItem:I}=y({items:b,itemToString(p){return p?p.Name:""},defaultHighlightedIndex:0,selectedItem:null,inputValue:u,stateReducer(p,a){const{changes:h,type:v}=a;switch(v){case y.stateChangeTypes.InputKeyDownEnter:case y.stateChangeTypes.ItemClick:return{...h,isOpen:!0,highlightedIndex:0};default:return h}},onStateChange({inputValue:p,type:a,selectedItem:h}){switch(a){case y.stateChangeTypes.InputKeyDownEnter:case y.stateChangeTypes.ItemClick:case y.stateChangeTypes.InputBlur:h&&(n([...l,h]),C(""));break;case y.stateChangeTypes.InputChange:C(p??"");break}}});return e("div",{className:"combo-container",children:[e("div",{className:"",children:[e("label",{className:"",...w(),children:t??"Select desired cards"}),e("div",{className:"",children:[l.map(function(a,h){return e("span",{className:"selected-items"+(o?" include":" exclude"),...S({selectedItem:a,index:h}),children:[a.Name,e("span",{class:"x",onClick:v=>{v.stopPropagation(),i(a)},children:"âœ•"})]},`selected-item-${h}`)}),e("div",{className:"",children:e("input",{placeholder:d??"Card Selection(s)",className:"",...m(g({preventKeyAction:c}))})})]})]}),e("ul",{className:`dropdown ${c&&b.length?"":"hidden"}`,...k(),children:[!1,c&&b.map((p,a)=>e("li",{className:H(D===a&&"bg-blue-300",I===p&&"font-bold","py-2 px-3 shadow-sm flex flex-col"),...r({item:p,index:a}),children:e("span",{children:p.Name})},`${p.ID}${a}`))]})]})}const H=(...n)=>n.filter(t=>t).join(" ");function _(n){let t="";if(!n.length)t="Spawn: any settings";else{for(let o=0;o<n.length;o++){const l=n[o];let s=o?`Reroll ${o}`:"Spawn";s+=": ",s+="Blueprints "+(l.spawnInside?"Spawn Inside":"Spawn Outside, "+(l.playerInside?"Someone Inside":"All Players Stand Outside")),o&&(s+=`, reroll ${n[o].blueprintCount} blueprints`),t+=s+`
`}t+=`Reroll ${n.length}: any settings`}const d=t.split(`
`);return e("div",{class:"reroll-instructions",onClick:o=>{if(o.detail<2)return;const l=document.createRange();l.selectNodeContents(o.currentTarget);const s=document.getSelection();s==null||s.removeAllRanges(),s==null||s.addRange(l)},children:d.map(o=>e("div",{children:o}))})}const T=x.filter(n=>n.Name==="Booking Desk"||n.Name==="Blueprint Cabinet").sort((n,t)=>n.Name<t.Name?1:-1);function j(n){const t=n.at(-1);return t!=null&&t.spawnInside?"I":t!=null&&t.playerInside?"OI":"OO"}const z=({seed:n,day:t,startingConfig:d=[],baseUpgradeChance:o=0,blueprintCount:l=5,searchDepth:s=2,ghostBlueprints:u=2,blueprintCabinets:C=1,solo:b,cards:S=[],appliances:g=[]})=>{var D;n=n.toLocaleLowerCase().trim();const i={blueprintCount:l+u,spawnInside:!0},c=new $(n,o);for(const r of S)c.addCard(r);c.OwnedAppliances=[...c.OwnedAppliances,...g];const f=[],w=[];for(let r=-C-1;r<=C;r++){const I={spawnInside:!0,blueprintCount:l+r};f.push(I),b||f.push({spawnInside:!1,playerInside:!0,blueprintCount:l+r}),f.push({spawnInside:!1,playerInside:!1,blueprintCount:l+r}),r===0&&(w.push(I),w.push({spawnInside:!1,playerInside:!0,blueprintCount:l+r}),w.push({spawnInside:!1,playerInside:!1,blueprintCount:l+r}))}let k=[],m=[d];for(let r=0;r<=s;r++){let I=[],p=[];for(let a=0;a<m.length;a++){const h={...i};h.blueprintCount=m[a].length?(((D=m[a].at(-1))==null?void 0:D.blueprintCount)??l)+u:l;const v=c.getAppliances([...m[a],h],t).map(R=>R.Name);p.push(e("td",{class:"reroll-cell "+j(m[a]),colspan:f.length**(s-r),children:[e(K,{bps:v,ghostCount:r===0?0:u}),_(m[a])]}));const B=d.length+r===0?w:f;for(const R of B){const O=[...m[a],R];I.push(O)}}k.push(e("tr",{children:[e("td",{children:r?`Reroll ${r}`:"Spawns"}),p]})),m=I}return e("table",{children:[" ",k," "]})},W=({onConfigChange:n,config:t})=>{const{seed:d,day:o,blueprintCount:l,solo:s,appliances:u=T,cards:C,searchDepth:b}=t,S=i=>{let c={...t};i.target.checked?(c.blueprintCount=7,c.baseUpgradeChance=.25):(c.blueprintCount=5,c.baseUpgradeChance=0),n(c)},g=(i,c)=>{let f={...t};f[i]=c,n(f)};return e("div",{children:[e("div",{children:[e("div",{children:"Run Config:"}),e("label",{for:"solo",children:"Solo:"}),e("input",{type:"checkbox",id:"solo",checked:s,onChange:()=>{g("solo",!s)}}),e("label",{for:"searchDepth",children:"Number of Rerolls"})," ",e("input",{id:"searchDepth",type:"number",value:b,onChange:i=>{g("searchDepth",Number(i.target.value))}}),e("br",{}),e("label",{for:"seed",value:d,children:["Seed:"," "]}),e("input",{type:"text",id:"seed",value:d,onChange:i=>{g("seed",i.target.value)}}),e("label",{for:"setting",children:"Turbo?"}),e("input",{id:"setting",type:"checkbox",checked:l===7,onChange:S})]}),e("div",{children:[e("label",{for:"day",value:o,children:["Prep of Day:"," "]}),e("input",{type:"number",id:"day",value:o+1,onChange:i=>{g("day",Number(i.target.value)-1)}}),e(U,{label:"Selected cards:",onSelectionChange:i=>{g("cards",i.cards)},showSelectionMode:!1,cards:C,include:!0,modes:["themes","dishes"]}),e(E,{label:"Select owned appliances:",placeholder:"",onSelectionChange:i=>{g("appliances",i)},appliances:u})]})]})},J={seed:"az",day:2,cards:[],initialRerollConfig:[],blueprintCount:5,baseUpgradeChance:0,solo:!1,appliances:T,searchDepth:2},Q=()=>{const[n,t]=G(J,"BRANCH_CONFIG");return e(P,{children:[e("div",{children:"Hover over a cell for instructions on how to get those blueprints. Getting the blueprints in grey requires taking extra blueprints out of cabinets"}),e(W,{onConfigChange:t,config:n}),e(z,{...n,blueprintCabinets:1}),!1,e(F,{})]})};A(e(Q,{}),document.getElementById("app"));
