import{u as o,g as D,q as T}from"./jsxRuntime.module-wfZfYPmn.js";import"./compat.module-qsrks2fs.js";import{I as v,S as U,A as P,G as F}from"./GhostBlueprints-tEGkeiHO.js";import{R as W,S as _,h as k,U as j}from"./unlocks-Gx_wR1Yr.js";import{F as G}from"./cards-bOlg6jZg.js";import{F as R,R as M}from"./prng-1rWzft78.js";function H(t=void 0){const r=t?new Date(t):new Date,l=r.getUTCFullYear(),c=t?new Date(t):new Date;c.setUTCMonth(0),c.setUTCDate(1),c.setUTCHours(0,0,0,0);let a=c.getUTCDay()%7;const p=(a?1:0)+Math.floor((r.valueOf()-c.valueOf()+a*24*60*60*1e3)/(7*24*60*60*1e3));return console.log({today:r,year:l,newYear:c,weekOffset:a,weeks:p}),console.log(`${l}, ${p}`),[l,p]}function E(){const t=L(),r=new R(t,8853129);let l=r.useSubcontext(0).random.range(0,5);const c=W[l],a=r.useSubcontext(1).random.select(_);return{seed:t,setting:c,dish:a,mapSize:q(t)}}function z(){const{seed:t,setting:r,dish:l,mapSize:c}=E();let a=[[r,l]];const p=new G(t);let f=[3,5,6,9,12];for(;f.length;){const g=f.shift();let m=[];for(;a.length;){const d=a.shift();p.cards=d,p.getUnlockOptions(g).forEach(h=>m.push([...d,h]))}a=m}return a}function L(){const[t,r]=H();return Y(200*t+r)}function Y(t){const r=new M(t);let l="";for(let c=0;c<8;c++)l+=v[r.range(0,v.length)];return l}function q(t){switch(new R(t,5078598).useSubcontext(0).random.range(0,8)){case 0:return[2,84];case 4:return[2,70];case 1:case 5:return[1,60];case 2:case 6:return[3,9*13];case 3:case 7:return[4,16*12];default:throw new Error("Layout index out of bounds")}}const O=E(),I=z(),x={[O.setting.Name]:!0,[O.dish.Name]:!0};for(let t=0;t<I[0].length;t++)for(const r of I)x[r[t].Name]===void 0&&(x[r[t].Name]=!1);console.log({weeklyConfig:O,cardPaths:I});const $=({defaultSeed:t=O.seed,disableSeedInput:r=!0,cardDefaults:l=x,maxRerolls:c})=>{const[a,p]=k(t),[f,g]=k(1),[m,d]=k(N),[u,h]=k(l),w=e=>{h(s=>({...s,[e.target.id]:e.target.checked}))};let S=[];for(const[e,s]of Object.entries(u))s&&S.push(e);const C={seed:a,day:f,upgradeChance:a.indexOf("az")>-1?.25:0,blueprintCount:a.indexOf("az")>-1?7:5,ownedAppliances:m,cards:S},b=e=>{g(Number(e.target.value))},y=e=>{p(e.target.value)},n=e=>{const s=e.target;d(i=>({...i,[s.id]:s.checked}))};return o(D,{children:[o("h3",{children:["Seed:"," ",r?a:o("input",{disabled:r,value:a,onChange:y})]}),o("label",{children:"Shop after completing day "}),o("input",{style:"border:none;width:2.5em",type:"number",value:f,onChange:b}),o("div",{children:Object.entries(u).map(([e,s])=>o("span",{style:"margin:0 20px 0 0",children:[o("label",{for:e,children:e}),o("input",{type:"checkbox",id:e,checked:s,onChange:w})]}))}),o("div",{children:A.map(e=>o("span",{style:"margin:0 25px 0 0",children:[o("label",{for:e,children:["Own ",e,"?"]}),o("input",{type:"checkbox",checked:m[e],id:e,onChange:n})]}))}),o(J,{...C,maxRerolls:c??K(f)})]})},N={},A=["Blueprint Cabinet","Plates","Research Desk"];for(const t of A)N[t]=!1;N["Blueprint Cabinet"]=!0;const Q=[!0,!1],V=[!0,!1],J=({seed:t,day:r=1,blueprintCount:l,upgradeChance:c,ownedAppliances:a,cards:p,maxRerolls:f})=>{const g=new U(t,c);for(let n=0;n<=p.length;n++)if(p[n]){const e=j.filter(s=>s.Name===p[n])[0];e&&g.addCard(e)}const m=Object.entries(a).filter(n=>n[1]).map(n=>n[0]).map(n=>P.filter(e=>e.Name===n)[0]);for(const n of m)n&&g.OwnedAppliances.push(n);let d=[];for(const n of V)for(const e of Q)if(d.push({spawnInside:n,playerInside:n?void 0:e,blueprintCount:l}),n)break;const u=[];let h=[[],[],[],[]];for(let n=0;n<d.length;n++)for(let e=0;e<d.length;e++){u.push([d[n],d[e]]);const s=[d[n].spawnInside,d[n].playerInside,d[e].spawnInside,d[e].playerInside];for(let i=0;i<s.length;i++)h[i].length&&h[i].at(-1).val===s[i]?h[i].at(-1).run+=1:h[i].push({val:s[i],run:1})}let w=[];const S=l,C=4,b=f;for(let n=0;n<b;n++){const e=[];for(const s of n?u:u.map(i=>[i[0]])){const i=[...s];n&&i.splice(-1,1,{...i.at(-1),blueprintCount:S+C}),e.push(g.getAppliances(i,r).map(B=>B.Name))}if(w.push(e),n)for(let s=0;s<u.length;s++)u[s].push(u[s][u[s].length-1])}const y=(n,e)=>{switch(n){case 0:return e?"Spawn Inside":"Spawn Outside";case 1:return e===void 0?"":e?"Stand Inside at End of Day":"Everyone Outside at End of Day";case 2:return e?"Spawn Inside for Rerolls":"Spawn Outside for Rerolls";case 3:return e===void 0?"":e?"Someone Inside when Rerolling":"Everyone Outside when Rerolling";default:throw new Error("Too Many Headers")}};return o("table",{children:[o("thead",{children:h.map((n,e)=>o("tr",{children:[!e&&o("th",{colSpan:1,rowSpan:4,children:"Reroll #"}),n.map(s=>s.val!==void 0&&o("th",{colSpan:s.run,rowSpan:y(e,s.val).indexOf("Spawn Inside")>-1?2:1,scope:"colgroup",children:y(e,s.val)}))]}))}),w.map((n,e)=>o("tr",{children:[o("th",{children:e||"Spawn"}),e?n.map(s=>o("td",{colspan:1,children:o(F,{ghostCount:C,bps:s})})):o("td",{style:"text-align:center;",colSpan:16,children:n[0].join(", ")})]}))]})};function K(t){return[5,8,10,12,13,15,16,18,19,20,21,22,23,24,25][t-1]+1}const X=["Breakfast","Breakfast Eggs","Breakfast Extras","Breakfast Beans","Pumpkin Seed"];for(const t of X);T(o($,{disableSeedInput:!0,maxRerolls:5}),document.getElementById("app"));
