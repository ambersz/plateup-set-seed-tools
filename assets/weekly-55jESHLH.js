var A=Object.defineProperty;var B=(t,n,s)=>n in t?A(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s;var U=(t,n,s)=>(B(t,typeof n!="symbol"?n+"":n,s),s);import{u as i,g as F,q as j}from"./jsxRuntime.module-wfZfYPmn.js";import{U as b,g as P,R as W,S as _,h as O,a as q}from"./unlocks-3e_N4jc9.js";import{F as I,R as M,A as H,G as z,S as L}from"./GhostBlueprints-OyXrGgbU.js";class Y{constructor(){U(this,"encourageGroups",[b.Special])}GetOptions(n,s,a){const c=a.random;let u=P(n),f=P(n,!1).length+1;for(console.log({autumn:u.length,non:f-1}),n.some(l=>l.Name==="Turbo")?s!==5&&(f+=u.length+1):n.some(l=>l.Name==="Community")?s===5&&(f+=u.length+2):console.error("This Setting is not implemented yet"),console.log({pad:f});f--;)c.value;let m=$(u,c);console.log(m.map(l=>l.Name).join(", "));const C=c.valueFloat<(n.some(l=>l.Name==="Turbo")?.1:.5),d=!n.some(l=>l.Name==="Community")||s===5;C&&(console.log("Prefer Priority"),m.sort((l,y)=>{let S=0;return(d&&l.Requires.length||this.encourageGroups.includes(l.UnlockGroup))&&S--,(d&&y.Requires.length||this.encourageGroups.includes(y.UnlockGroup))&&S++,S}));const p=s===5?b.PrimaryTheme:b.Dish,g=s===5?b.PrimaryTheme:n.some(l=>l.Name==="Community")?b.Dish:b.Generic;let k=null,w=null;for(const l of m)if(!(l.UnlockGroup!==p&&l.UnlockGroup!==g)&&(k===null||k.UnlockGroup!==p&&l.UnlockGroup===p?k=l:(w===null||w.UnlockGroup!==g&&l.UnlockGroup===g)&&(w=l),k&&k.UnlockGroup===p&&w&&w.UnlockGroup===g))break;return[k,w]}}function $(t,n){return t.map(a=>[a,n.valueFloat]).sort((a,c)=>a[1]-c[1]).map(a=>a[0])}class Q{constructor(n){U(this,"cards");U(this,"unlockPack");U(this,"seed");this.cards=[],this.unlockPack=new Y,this.seed=n}addCard(n){n!==void 0&&this.cards.push(n)}getUnlockOptions(n){const a=V(848292,n,this.seed).useSubcontext(1);return this.unlockPack.GetOptions(this.cards,n,a)}}function V(t,n,s){return new I(s,t*1231231+n)}function J(t=void 0){const n=t?new Date(t):new Date,s=n.getUTCFullYear(),a=t?new Date(t):new Date;a.setUTCMonth(0),a.setUTCDate(1),a.setUTCHours(0,0,0,0);let c=(a.getUTCDay()+6)%7;const u=(c?1:0)+Math.floor((n.valueOf()-a.valueOf()+c*24*60*60*1e3)/(7*24*60*60*1e3));return console.log({today:n,year:s,newYear:a,weekOffset:c,weeks:u}),console.log(`${s}, ${u}`),[s,u]}function T(){const t=X(),n=new I(t,8853129);let s=n.useSubcontext(0).random.range(0,5);const a=W[s],c=n.useSubcontext(1).random.select(_);return{seed:t,setting:a,dish:c,mapSize:ee(t)}}function K(){const{seed:t,setting:n,dish:s,mapSize:a}=T();let c=[[n,s]];const u=new Q(t);let f=[3,5,6,9,12];for(;f.length;){const m=f.shift();let C=[];for(;c.length;){const d=c.shift();u.cards=d,u.getUnlockOptions(m).forEach(g=>C.push([...d,g]))}c=C}return c}function X(){const[t,n]=J();return Z(200*t+n)}const R="bdghjmqrtvwxy346789";function Z(t){const n=new M(t);let s="";for(let a=0;a<8;a++)s+=R[n.range(0,R.length)];return s}function ee(t){switch(new I(t,5078598).useSubcontext(0).random.range(0,8)){case 0:return[2,84];case 4:return[2,70];case 1:case 5:return[1,60];case 2:case 6:return[3,9*13];case 3:case 7:return[4,16*12];default:throw new Error("Layout index out of bounds")}}const G=T(),x=K(),N={[G.setting.Name]:!0,[G.dish.Name]:!0};for(let t=0;t<x[0].length;t++)for(const n of x)N[n[t].Name]===void 0&&(N[n[t].Name]=!1);console.log({weeklyConfig:G,cardPaths:x});const ne=({defaultSeed:t=G.seed,disableSeedInput:n=!0,cardDefaults:s=N,maxRerolls:a})=>{const[c,u]=O(t),[f,m]=O(1),[C,d]=O(v),[p,g]=O(s),k=e=>{g(r=>({...r,[e.target.id]:e.target.checked}))};let w=[];for(const[e,r]of Object.entries(p))r&&w.push(e);const l={seed:c,day:f,upgradeChance:c.indexOf("az")>-1?.25:0,blueprintCount:c.indexOf("az")>-1?7:5,ownedAppliances:C,cards:w},y=e=>{m(Number(e.target.value))},S=e=>{u(e.target.value)},o=e=>{const r=e.target;d(h=>({...h,[r.id]:r.checked}))};return i(F,{children:[i("h3",{children:["Seed:"," ",n?c:i("input",{disabled:n,value:c,onChange:S})]}),i("label",{children:"Shop after completing day "}),i("input",{style:"border:none;width:2.5em",type:"number",value:f,onChange:y}),i("div",{children:Object.entries(p).map(([e,r])=>i("span",{style:"margin:0 20px 0 0",children:[i("label",{for:e,children:e}),i("input",{type:"checkbox",id:e,checked:r,onChange:k})]}))}),i("div",{children:D.map(e=>i("span",{style:"margin:0 25px 0 0",children:[i("label",{for:e,children:["Own ",e,"?"]}),i("input",{type:"checkbox",checked:C[e],id:e,onChange:o})]}))}),i(se,{...l,maxRerolls:a??re(f)})]})},v={},D=["Blueprint Cabinet","Plates","Research Desk"];for(const t of D)v[t]=!1;v["Blueprint Cabinet"]=!0;const te=[!0,!1],oe=[!0,!1],se=({seed:t,day:n=1,blueprintCount:s,upgradeChance:a,ownedAppliances:c,cards:u,maxRerolls:f})=>{const m=new L(t,a);for(let o=0;o<=u.length;o++)if(u[o]){const e=q.filter(r=>r.Name===u[o])[0];e&&m.addCard(e)}const C=Object.entries(c).filter(o=>o[1]).map(o=>o[0]).map(o=>H.filter(e=>e.Name===o)[0]);for(const o of C)o&&m.OwnedAppliances.push(o);let d=[];for(const o of oe)for(const e of te)if(d.push({spawnInside:o,playerInside:o?void 0:e,blueprintCount:s}),o)break;const p=[];let g=[[],[],[],[]];for(let o=0;o<d.length;o++)for(let e=0;e<d.length;e++){p.push([d[o],d[e]]);const r=[d[o].spawnInside,d[o].playerInside,d[e].spawnInside,d[e].playerInside];for(let h=0;h<r.length;h++)g[h].length&&g[h].at(-1).val===r[h]?g[h].at(-1).run+=1:g[h].push({val:r[h],run:1})}let k=[];const w=s,l=4,y=f;for(let o=0;o<y;o++){const e=[];for(const r of o?p:p.map(h=>[h[0]])){const h=[...r];o&&h.splice(-1,1,{...h.at(-1),blueprintCount:w+l}),e.push(m.getAppliances(h,n).map(E=>E.Name))}if(k.push(e),o)for(let r=0;r<p.length;r++)p[r].push(p[r][p[r].length-1])}const S=(o,e)=>{switch(o){case 0:return e?"Spawn Inside":"Spawn Outside";case 1:return e===void 0?"":e?"Stand Inside at End of Day":"Everyone Outside at End of Day";case 2:return e?"Spawn Inside for Rerolls":"Spawn Outside for Rerolls";case 3:return e===void 0?"":e?"Someone Inside when Rerolling":"Everyone Outside when Rerolling";default:throw new Error("Too Many Headers")}};return i("table",{children:[i("thead",{children:g.map((o,e)=>i("tr",{children:[!e&&i("th",{colSpan:1,rowSpan:4,children:"Reroll #"}),o.map(r=>r.val!==void 0&&i("th",{colSpan:r.run,rowSpan:S(e,r.val).indexOf("Spawn Inside")>-1?2:1,scope:"colgroup",children:S(e,r.val)}))]}))}),k.map((o,e)=>i("tr",{children:[i("th",{children:e||"Spawn"}),e?o.map(r=>i("td",{colspan:1,children:i(z,{ghostCount:l,bps:r})})):i("td",{style:"text-align:center;",colSpan:16,children:o[0].join(", ")})]}))]})};function re(t){return[5,8,10,12,13,15,16,18,19,20,21,22,23,24,25][t-1]+1}const ae=["Breakfast","Breakfast Eggs","Breakfast Extras","Breakfast Beans","Pumpkin Seed"];for(const t of ae);j(i(ne,{disableSeedInput:!0,maxRerolls:5}),document.getElementById("app"));
