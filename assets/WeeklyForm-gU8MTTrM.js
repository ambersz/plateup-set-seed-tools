var E=Object.defineProperty;var F=(t,e,s)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var O=(t,e,s)=>(F(t,typeof e!="symbol"?e+"":e,s),s);import{U as b,a as P,R as W,S as j,h as U,u as c,g as _,b as B}from"./jsxRuntime.module-6iCSpIbC.js";import{F as v,R as q,A as M,G as z,S as H}from"./GhostBlueprints-b_TuWfVm.js";class L{constructor(){O(this,"encourageGroups",[b.Special])}GetOptions(e,s,i){const a=i.random;let g=P(e),h=P(e,!1).length+1;for(console.log({autumn:g.length,non:h-1}),e.some(l=>l.Name==="Turbo")?s!==5&&(h+=g.length+1):e.some(l=>l.Name==="Community")?s===5&&(h+=g.length+2):console.error("This Setting is not implemented yet"),console.log({pad:h});h--;)a.value;let m=Y(g,a);console.log(m.map(l=>l.Name).join(", "));const C=a.valueFloat<(e.some(l=>l.Name==="Turbo")?.1:.5),u=!e.some(l=>l.Name==="Community")||s===5;C&&(console.log("Prefer Priority"),m.sort((l,y)=>{let S=0;return(u&&l.Requires.length||this.encourageGroups.includes(l.UnlockGroup))&&S--,(u&&y.Requires.length||this.encourageGroups.includes(y.UnlockGroup))&&S++,S}));const d=s===5?b.PrimaryTheme:b.Dish,f=s===5?b.PrimaryTheme:e.some(l=>l.Name==="Community")?b.Dish:b.Generic;let w=null,k=null;for(const l of m)if(!(l.UnlockGroup!==d&&l.UnlockGroup!==f)&&(w===null||w.UnlockGroup!==d&&l.UnlockGroup===d?w=l:(k===null||k.UnlockGroup!==f&&l.UnlockGroup===f)&&(k=l),w&&w.UnlockGroup===d&&k&&k.UnlockGroup===f))break;return[w,k]}}function Y(t,e){return t.map(i=>[i,e.valueFloat]).sort((i,a)=>i[1]-a[1]).map(i=>i[0])}class ${constructor(e){O(this,"cards");O(this,"unlockPack");O(this,"seed");this.cards=[],this.unlockPack=new L,this.seed=e}addCard(e){e!==void 0&&this.cards.push(e)}getUnlockOptions(e){const i=Q(848292,e,this.seed).useSubcontext(1);return this.unlockPack.GetOptions(this.cards,e,i)}}function Q(t,e,s){return new v(s,t*1231231+e)}function V(){const t=new Date,e=t.getUTCFullYear(),s=new Date(e,0,1,0);let i=(s.getUTCDay()+6)%7;const a=(i?1:0)+Math.floor((t.valueOf()-s.valueOf()+i*24*60*60*1e3)/(7*24*60*60*1e3));return console.log({today:t,year:e,newYear:s,weekOffset:i,weeks:a}),console.log(`${e}, ${a}`),[e,a]}function T(){const t=K(),e=new v(t,8853129);let s=e.useSubcontext(0).random.range(0,5);const i=W[s],a=e.useSubcontext(1).random.select(j);return{seed:t,setting:i,dish:a,mapSize:Z(t)}}function J(){const{seed:t,setting:e,dish:s,mapSize:i}=T();let a=[[e,s]];const g=new $(t);let h=[3,5,6,9,12];for(;h.length;){const m=h.shift();let C=[];for(;a.length;){const u=a.shift();g.cards=u,g.getUnlockOptions(m).forEach(f=>C.push([...u,f]))}a=C}return a}function K(){const[t,e]=V();return X(200*t+e)}const R="bdghjmqrtvwxy346789";function X(t){const e=new q(t);let s="";for(let i=0;i<8;i++)s+=R[e.range(0,R.length)];return s}function Z(t){switch(new v(t,5078598).useSubcontext(0).random.range(0,8)){case 0:return[2,84];case 4:return[2,70];case 1:case 5:return[1,60];case 2:case 6:return[3,9*13];case 3:case 7:return[4,16*12];default:throw new Error("Layout index out of bounds")}}const G=T(),x=J(),N={[G.setting.Name]:!0,[G.dish.Name]:!0};for(let t=0;t<x[0].length;t++)for(const e of x)N[e[t].Name]===void 0&&(N[e[t].Name]=!1);console.log({weeklyConfig:G,cardPaths:x});const ae=({defaultSeed:t=G.seed,disableSeedInput:e=!0,cardDefaults:s=N,maxRerolls:i})=>{const[a,g]=U(t),[h,m]=U(1),[C,u]=U(I),[d,f]=U(s),w=n=>{f(r=>({...r,[n.target.id]:n.target.checked}))};let k=[];for(const[n,r]of Object.entries(d))r&&k.push(n);const l={seed:a,day:h,upgradeChance:a.indexOf("az")>-1?.25:0,blueprintCount:a.indexOf("az")>-1?7:5,ownedAppliances:C,cards:k},y=n=>{m(Number(n.target.value))},S=n=>{g(n.target.value)},o=n=>{const r=n.target;u(p=>({...p,[r.id]:r.checked}))};return c(_,{children:[c("h3",{children:["Seed:"," ",e?a:c("input",{disabled:e,value:a,onChange:S})]}),c("label",{children:"Shop after completing day "}),c("input",{style:"border:none;width:2.5em",type:"number",value:h,onChange:y}),c("div",{children:Object.entries(d).map(([n,r])=>c("span",{style:"margin:0 20px 0 0",children:[c("label",{for:n,children:n}),c("input",{type:"checkbox",id:n,checked:r,onChange:w})]}))}),c("div",{children:A.map(n=>c("span",{style:"margin:0 25px 0 0",children:[c("label",{for:n,children:["Own ",n,"?"]}),c("input",{type:"checkbox",checked:C[n],id:n,onChange:o})]}))}),c(te,{...l,maxRerolls:i??oe(h)})]})},I={},A=["Blueprint Cabinet","Plates","Research Desk"];for(const t of A)I[t]=!1;I["Blueprint Cabinet"]=!0;const ee=[!0,!1],ne=[!0,!1],te=({seed:t,day:e=1,blueprintCount:s,upgradeChance:i,ownedAppliances:a,cards:g,maxRerolls:h})=>{const m=new H(t,i);for(let o=0;o<=g.length;o++)if(g[o]){const n=B.filter(r=>r.Name===g[o])[0];n&&m.addCard(n)}const C=Object.entries(a).filter(o=>o[1]).map(o=>o[0]).map(o=>M.filter(n=>n.Name===o)[0]);for(const o of C)o&&m.OwnedAppliances.push(o);let u=[];for(const o of ne)for(const n of ee)if(u.push({spawnInside:o,playerInside:o?void 0:n,blueprintCount:s}),o)break;const d=[];let f=[[],[],[],[]];for(let o=0;o<u.length;o++)for(let n=0;n<u.length;n++){d.push([u[o],u[n]]);const r=[u[o].spawnInside,u[o].playerInside,u[n].spawnInside,u[n].playerInside];for(let p=0;p<r.length;p++)f[p].length&&f[p].at(-1).val===r[p]?f[p].at(-1).run+=1:f[p].push({val:r[p],run:1})}let w=[];const k=s,l=4,y=h;for(let o=0;o<y;o++){const n=[];for(const r of o?d:d.map(p=>[p[0]])){const p=[...r];o&&p.splice(-1,1,{...p.at(-1),blueprintCount:k+l}),n.push(m.getAppliances(p,e).map(D=>D.Name))}if(w.push(n),o)for(let r=0;r<d.length;r++)d[r].push(d[r][d[r].length-1])}const S=(o,n)=>{switch(o){case 0:return n?"Spawn Inside":"Spawn Outside";case 1:return n===void 0?"":n?"Stand Inside at End of Day":"Everyone Outside at End of Day";case 2:return n?"Spawn Inside for Rerolls":"Spawn Outside for Rerolls";case 3:return n===void 0?"":n?"Someone Inside when Rerolling":"Everyone Outside when Rerolling";default:throw new Error("Too Many Headers")}};return c("table",{children:[c("thead",{children:f.map((o,n)=>c("tr",{children:[!n&&c("th",{colSpan:1,rowSpan:4,children:"Reroll #"}),o.map(r=>r.val!==void 0&&c("th",{colSpan:r.run,rowSpan:S(n,r.val).indexOf("Spawn Inside")>-1?2:1,scope:"colgroup",children:S(n,r.val)}))]}))}),w.map((o,n)=>c("tr",{children:[c("th",{children:n||"Spawn"}),n?o.map(r=>c("td",{colspan:1,children:c(z,{ghostCount:l,bps:r})})):c("td",{style:"text-align:center;",colSpan:16,children:o[0].join(", ")})]}))]})};function oe(t){return[5,8,10,12,13,15,16,18,19,20,21,22,23,24,25][t-1]+1}export{ae as W};
