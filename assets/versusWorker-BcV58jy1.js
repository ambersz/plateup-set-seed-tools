var be=Object.defineProperty;var ye=(b,g,R)=>g in b?be(b,g,{enumerable:!0,configurable:!0,writable:!0,value:R}):b[g]=R;var T=(b,g,R)=>ye(b,typeof g!="symbol"?g+"":g,R);(function(){"use strict";var b=(t=>(t[t.Generic=0]="Generic",t[t.Dish=1]="Dish",t[t.PrimaryTheme=3]="PrimaryTheme",t[t.SecondaryTheme=4]="SecondaryTheme",t[t.Franchise=5]="Franchise",t[t.Special=6]="Special",t))(b||{}),g=(t=>(t[t.Base=0]="Base",t[t.Main=1]="Main",t[t.Extra=2]="Extra",t[t.Side=3]="Side",t[t.Starter=4]="Starter",t[t.Dessert=5]="Dessert",t[t.Null=6]="Null",t))(g||{}),R=`373996608,Ice Cream,1,,,,-1533430406,False,False,5,1,2\r
-2075899,Breakfast,1,,,-523839730:-1706154991,380220741:925796718,True,False,0,0,5\r
-1199743580,Breakfast Beans,1,-2075899,,,1807525572:-957949759,False,False,2,1,0\r
1436814208,Breakfast Eggs,1,-2075899,,,961148621,False,False,2,1,0\r
-1998930853,Breakfast Extras,1,-2075899,,,-712909563:-1097889139,False,False,2,1,0\r
-1778969928,Burgers,1,,,1972879238,759552160:380220741:385684499,True,False,0,-2,3\r
965292477,Cheeseburgers,1,-1778969928,,,759552160:380220741:385684499:-117339838,False,False,2,1,0\r
-1091625127,Fresh Patties,1,-1778969928,,,759552160:380220741:961148621:-484165118,False,False,2,1,0\r
1298035216,Burger Toppings,1,-1778969928,,,759552160:380220741:-712909563:385684499:-2042103798,False,False,2,1,0\r
1626323920,Hot Dogs,1,,,1972879238,-1132411297:380220741:1799769627:-965827229,True,False,0,-1,5\r
-278713285,Hot Dog - Mustard,1,1626323920,,,-117356585,False,False,2,1,0\r
1743900205,Fish,1,,,1972879238,-609358791:380220741:-1735137431,True,False,0,1,5\r
-297968808,Crab Cake,1,1743900205,,2087693779:1972879238,380220741:925796718:961148621,True,False,1,1,8\r
243846255,Fish Selection,1,1442262270,,,-609358791,False,False,2,0,0\r
-243820179,Fish Selection,1,274986412,,,-609358791,False,False,2,0,0\r
1442262270,Fish Fillet,1,1743900205,,1972879238:2087693779,380220741,True,False,1,1,5\r
274986412,Oysters,1,1743900205,,2087693779,380220741,True,False,1,1,5\r
-643878280,Spiny Fish,1,1743900205,,2087693779,380220741,True,False,1,1,5\r
-211821608,Apple Pies,1,,,2087693779:1972879238:-523839730,925796718:-266993023:-905438738,False,False,5,1,3\r
-133939790,Pies,1,,,-1706154991:-523839730,925796718:-484165118:-266993023:380220741,True,False,0,1,8\r
-1992316049,Mushroom Pie,1,-133939790,,,-1097889139:925796718:-266993023,False,False,1,1,0\r
-1802123036,Vegetable Pies,1,-133939790,,,925796718:-266993023:-452101383:-1573812073,False,False,1,1,0\r
1570910782,Apple Salad,1,1356267749,,2087693779,1193867305:-712909563:380220741:-905438738:1834063794:-1963699221:961148621,True,False,1,2,8\r
1356267749,Salad,1,,,2087693779,1193867305:-712909563:380220741,True,False,0,-1,5\r
-862637543,Potato Salad,1,1356267749,,2087693779:1972879238,-1963699221:961148621:44541785:-957949759:-2042103798:-266993023,True,False,1,2,8\r
372460604,Salad Toppings,1,1356267749,,,-1434800013:-2042103798,False,False,2,1,0\r
1384317454,Bone-in Steaks,1,-959076098,,1972879238,269523389,True,False,1,1,5\r
-959076098,Steak,1,,,1972879238,-484165118:380220741,True,False,0,0,5\r
-953651922,Steak Sauce - Mushroom,1,-959076098,,,-1097889139:-266993023:-2042103798:-957949759,False,False,2,1,0\r
2074054556,Steak Sauce - Red Wine Jus,1,-959076098,,,-957949759:-2042103798:-266993023:-1353971407,False,False,2,1,0\r
-1192928429,Steak Topping - Mushroom,1,-959076098,,,-1097889139,False,False,2,1,0\r
-851525606,Steak Topping - Tomato,1,-959076098,,,-712909563,False,False,2,1,0\r
1916300984,Thick Cut Steaks,1,-959076098,,1972879238,-1507801323,True,False,1,1,5\r
-1716993344,Thin Cut Steaks,1,-959076098,,1972879238,1800865634,True,False,1,1,5\r
-1653221873,Stir Fry,1,,,2087693779:1972879238,-452101383:-1573812073:380220741:-1201769154:314862254,True,False,0,1,10\r
-204178430,Steak Stir Fry,1,-1653221873,,,-1201769154:314862254:-484165118:-452101383:380220741:-1573812073,False,False,1,1,0\r
1380953991,Broccoli,1,,,1972879238,-1573812073:-957949759:-266993023,False,True,3,1,1\r
-520693398,Chips,1,,,1972879238:2087693779,44541785,False,True,3,1,2\r
364243605,Mashed Potato,1,,,1972879238:2087693779,-957949759:44541785:-266993023,False,True,3,1,1\r
2012685115,Carrot Soup,1,,,1972879238,-266993023:-2042103798:-452101383:-957949759,False,True,4,1,3\r
-997241706,Meat Soup,1,,,1972879238,-484165118:-2042103798:-957949759:-266993023,False,True,4,1,3\r
-233806503,Tomato Soup,1,,,1972879238:2087693779,-712909563:-2042103798:-957949759:-266993023,False,True,4,1,3\r
312770813,Cheese Board,1,,,2087693779,-905438738:235423916:-117339838:1834063794,False,False,5,1,3\r
550743424,Pizza,1,,,2087693779:-1706154991:-523839730,925796718:-1963699221:-117339838:-712909563:380220741,True,False,0,0,5\r
1434421325,Mushroom Pizza,1,550743424,,,925796718:-1963699221:-117339838:-712909563:380220741:-1097889139,False,False,2,1,0\r
-2071275506,Onion Pizza,1,550743424,,,-117339838:925796718:-2042103798:-1963699221:380220741:-712909563,False,False,2,1,0\r
-1745179096,Onion Rings,1,,,1972879238:2087693779,-2042103798:925796718,False,True,3,1,2\r
1642577536,Herd Mentality,0,,,,,False,False,6,0,0\r
-1737101581,Health and Safety,0,,,,,False,False,6,0,0\r
-2040314977,Picky Eaters,0,,,,,False,False,6,0,0\r
73422455,Tipping Culture,0,,,,,False,False,6,0,0\r
1168007081,Corn on the Cob,1,,,1972879238,976574457,False,True,3,1,3\r
400765800,Pumpkin Pies,1,,,2087693779:1972879238:-523839730,-1055654549:925796718,False,False,5,1,3\r
1393945424,Pumpkin Seed,1,,,1972879238,-1055654549,False,True,4,1,3\r
1984233383,Pumpkin Soup,1,,,1972879238,-266993023:-2042103798:-1055654549:-957949759,False,True,4,1,2\r
1838568431,Trick - Nasty Nightmares,6,,,,,False,False,6,1,0\r
61056284,Trick - Risky Reservations,6,,,,,False,False,6,1,0\r
2112990883,Trick - Freak Fires,6,,,,,False,False,6,2,0\r
-1477157706,Trick - Mysterious Messes,6,,,,,False,False,6,1,0\r
-209485820,Trick - Dark Deliberations,6,,,,,False,False,6,1,0\r
83673522,Trick - Spooky Solos,6,,,,,False,False,6,1,0\r
1139286658,Trick - Pyro Patrons,6,,,,,False,False,6,2,0\r
79859072,Trick - Cowardly Customers,6,,,,,False,False,6,1,0\r
-2123879305,Trick - Full of Friends,6,,,,,False,False,6,1,0\r
-1895806374,Trick - Grand Gesture,6,,,,,False,False,6,1,0\r
-269971294,Trick - Frightful Fluff,6,,,,,False,False,6,1,0\r
1892828942,Trick - Immortal Impatience,6,,,,,False,False,6,2,0\r
524188336,Trick - Foggy Food,6,,,,,False,False,6,1,0\r
797208634,Trick - Vanishing Valuables,6,,,,,False,False,6,1,0\r
561747534,Trick - Careful Conveyance,6,,,,,False,False,6,1,0\r
-1921275517,Trick - Tiring Times,6,,,,,False,False,6,1,0\r
319209671,Community,6,,,,,False,False,6,1,0\r
536093200,Nut Roast,1,1551533879,,2087693779:-1706154991,1834063794:380220741:-2042103798,True,False,1,1,5\r
-1405391769,Affogato,1,16318784:373996608,,,-1609758240:-1533430406,False,False,5,1,1\r
1847735819,Bread,1,,,1972879238,925796718:235423916,False,True,4,1,2\r
-1015158173,Broccoli Cheese Soup,1,,,1972879238,-1573812073:-957949759:-117339838:-266993023:-2042103798,False,True,4,1,2\r
12170609,Cherry Pie,1,,,1972879238,148543530:925796718:-266993023,False,False,5,1,3\r
-1289628495,Roast Potato,1,,,1972879238,44541785,False,True,3,1,1\r
1551533879,Turkey,1,,,-1706154991,-1506824829:380220741,True,False,0,1,5\r
-361249036,Christmas Rush,6,,,,,False,False,6,0,0\r
878396172,Christmas Crackers,1,1551533879,,,303858729,False,True,4,1,3\r
1398180456,Turkey - Cranberry Sauce,1,1551533879,,,735786885:-2133205155,False,False,2,1,0\r
-1460640973,Turkey - Gravy,1,1551533879,,,-2042103798:-957949759:-266993023,False,False,2,1,0\r
-1243742384,Turkey - Stuffing,1,1551533879,,,-2042103798:925796718:-266993023,False,False,2,2,0\r
-1273613313,Lucky Gift,6,,,,,False,False,6,1,0\r
-1742801708,Bamboo,1,,,1972879238,-2092567672:-266993023:-957949759,False,True,3,1,2\r
-437161441,Bamboo Stir Fry,1,-1653221873,,,-1201769154:314862254:-2092567672:-452101383:380220741:-1573812073:-957949759:-266993023,False,False,1,1,0\r
-1759612454,Dumpling - Soy Sauce,1,367917843,,,-471813067,False,False,2,1,0\r
367917843,Dumplings,1,,,1972879238:-523839730:2087693779,925796718:-484165118:-452101383:380220741,True,False,0,2,8\r
137627410,Seaweed,1,367917843,,,595306349,False,False,2,1,0\r
1696424557,Mandarin Starter,1,,,,-1210117767,False,True,4,1,2\r
1642878331,Mushroom Stir Fry,1,-1653221873,,,-1097889139:-1573812073:-452101383:380220741:-1201769154:314862254,False,False,1,1,0\r
1064343768,Stir Fry - Soy Sauce,1,-1653221873,,,-471813067,False,False,2,1,0\r
-2106646073,Couples,6,,,,,False,False,6,0,0\r
2028238661,Double Dates,0,-2106646073,,,,False,False,6,0,0\r
587399881,First Dates,0,-2106646073,,,,False,False,6,0,0\r
251686519,Double Brew,0,746549422,,,,False,False,6,0,0\r
2079359756,Slow Brew Coffee,1,746549422:16318784,,,,False,False,6,0,0\r
1103885337,Cake Stand,1,16318784:16318784,,,143484231,False,False,2,1,0\r
16318784,Black Coffee,1,,,-1316622579,-1609758240,False,False,0,-2,1\r
-740215310,Extra Milk,1,16318784,,,120342736,False,False,2,1,0\r
-696561631,Extra Sugar,1,16318784,,,-2133205155,False,False,2,1,0\r
2133632711,Iced Coffee,1,16318784,,-1316622579,-1609758240:801015432,False,False,2,1,2\r
-141282934,Latte,1,16318784,,-1316622579:510796221,-1609758240:120342736,False,False,2,1,2\r
1398671754,Tea,1,16318784,,,-1598460622:1377093570:-762638188:-266993023,False,False,2,1,3\r
1316998108,Sponge Cake,1,1113735761,,,-660310536:961148621:925796718:120342736:-217313684:-2133205155,False,False,5,-1,0\r
1609120418,Brownies,1,1113735761,,,783588616:-2135982034:961148621:925796718:-217313684:-2133205155,False,False,5,-1,0\r
-810134986,Cake Flavour - Coffee,1,1113735761,,-1316622579,-1609758240,False,False,5,1,3\r
-1693098895,Cake Flavour - Lemon,1,1113735761,,2087693779,1470180731,False,False,5,1,3\r
627241196,Cupcake,1,1113735761,,,-315287689:961148621:925796718:120342736:-217313684:-2133205155,False,False,5,-1,0\r
-1166412657,Doughnut,1,1113735761,,,2136474391:961148621:925796718:120342736:-217313684:-2133205155:-1963699221:-957949759,False,False,5,-1,0\r
1113735761,Cakes,0,,,-1706154991:-523839730:1972879238,-1723125645:961148621:925796718:-217313684:-2133205155:783588616,False,False,0,0,3\r
-1501485763,Spaghetti Bolognese,1,1764920765,,1972879238:2087693779,-1541798751:-182748008:-266993023:-957949759:380220741:-712909563,True,False,1,1,5\r
803049136,Lasagne,1,-1501485763:1651927267,,-1706154991:1972879238:-523839730,-2077197906:-1541798751:-215543585:120342736:925796718:-957949759:380220741:-712909563:-1339944542,True,False,1,2,8\r
1651927267,Cheesy Spaghetti,1,1764920765,,1972879238:2087693779,925796718:-182748008:-266993023:-957949759:380220741:120342736:-215543585:-117339838,True,False,1,1,5\r
675343178,Tacos - Cheese,1,506626805,,,-117339838,False,False,2,1,0\r
-2122069505,Tacos - Lettuce,1,506626805,,,1193867305,False,False,2,1,0\r
706991842,Tacos - Onion,1,506626805,,,-2042103798,False,False,2,1,0\r
-1656665053,Tacos - Tomato,1,506626805,,,-712909563,False,False,2,1,0\r
2055765569,Double Helpings,0,-347199069,,,,False,False,6,1,0\r
-347199069,All You Can Eat,0,,,,,False,False,6,2,0\r
233335391,Personalised Waiting,0,,,,,False,False,6,0,0\r
-1815978981,Closing Time?,0,,,,,False,False,6,0,0\r
-287956430,Leisurely Eating,0,,,,,False,False,6,1,0\r
220354841,Sedate Atmosphere,0,,,,,False,False,6,0,0\r
-37551439,Dinner Rush,0,,1958825350,,,False,False,6,0,0\r
-2112255403,Flexible Dining,0,-1183014556,,,,False,False,6,0,0\r
-1747821833,Individual Dining,0,,-1183014556,,,False,False,6,0,0\r
-523195599,Large Groups,0,-1183014556,,,,False,False,6,0,0\r
-1183014556,Medium Groups,0,,-1747821833,,,False,False,6,0,0\r
165138001,Photographic Memory,0,,,,,False,False,6,0,0\r
-28708234,Empathy,0,,,,,False,False,6,0,0\r
-1617744928,Blindfolded Chefs,0,,,,,False,False,6,0,0\r
1530184692,Instant Service,0,,746549422,,,False,False,6,0,0\r
113582858,Discounts,0,,,,,False,False,6,0,0\r
-913531466,Victorian Standards,0,,,,,False,False,6,0,0\r
-53330922,Lunch Rush,0,,1958825350,,,False,False,6,0,0\r
-491994319,Splash Zone,0,,,,,False,False,6,0,0\r
1151685289,Relaxed Atmosphere,0,,,,,False,False,6,0,0\r
73387665,Advertising,0,1765310572,,,,False,False,6,0,0\r
1765310572,Advertising,0,,,,,False,False,6,0,0\r
2079763934,Morning Rush,0,,1958825350,,,False,False,6,0,0\r
1914014233,Simplicity,0,,,,,False,False,6,0,0\r
-534291083,High Expectations,0,,,,,False,False,6,0,0\r
-957080051,High Standards,0,,1356267749,,,False,False,6,0,0\r
1103452725,High Quality,0,,,,,False,False,6,0,0\r
-1857686620,Affordable,3,,,,,False,False,6,0,0\r
1293847744,Charming,3,,,,,False,False,6,0,0\r
-1323758054,Exclusive,3,,,,,False,False,6,0,0\r
-1641333859,Formal,3,,,,,False,False,6,0,0\r
409052852,Variety,5,,319209671:16318784,,,False,False,6,0,0\r
-1205203705,Careful Accounting,5,,,,,False,False,6,-2,0\r
-947047181,Mandatory Tips,5,,,,,False,False,6,-2,0\r
1298492736,Grabber,5,,,,,False,False,6,-2,0\r
1173444265,Wash Basin,5,,,,,False,False,6,-2,0\r
-1096314451,Savings,5,,,,,False,False,6,-2,0\r
2022427578,Reincarnation,5,,,,,False,False,6,-2,0\r
-401283600,Preparation Time,5,,,,,False,False,6,-2,0\r
-357483693,Double Homework,5,,,,,False,False,6,-2,0\r
868780472,Catalogue,5,,,,,False,False,6,-2,0\r
-1418317596,Coupons,5,,,,,False,False,6,-2,0\r
-98765415,Supplier Error,5,,,,,False,False,6,-2,0\r
1618418478,Bootstrapping,5,,,,,False,False,6,-2,0\r
1543829883,Second Helpings,5,,,,,False,False,6,-2,0\r
-1010143518,Loyal Customer,5,,,,,False,False,6,-2,0\r
-1269806478,High Tech Suppliers,5,,,,,False,False,6,-2,0\r
1818403570,Conveyors,5,,,,,False,False,6,-2,0\r
-1121427945,Coffee Tables,5,,,,,False,False,6,-2,0\r
1101419251,Floor Protectors,5,,,,,False,False,6,-2,0\r
-220105135,Flower Pots,5,,,,,False,False,6,-2,0\r
-178381693,Metal Table,5,,,,,False,False,6,0,0\r
-373772933,Simple Cloth Table,5,,,,,False,False,6,0,0\r
`,K=`-959076098,Steak,1,1972879238,-484165118:380220741,True,False,0,0,5\r
1356267749,Salad,1,2087693779,1193867305:-712909563:380220741,True,False,0,-1,5\r
550743424,Pizza,1,2087693779:-1706154991:-523839730,925796718:-1963699221:-117339838:-712909563:380220741,True,False,0,0,5\r
367917843,Dumplings,1,1972879238:-523839730:2087693779,925796718:-484165118:-452101383:380220741,True,False,0,2,8\r
16318784,Black Coffee,1,-1316622579,-1609758240,False,False,0,-2,1\r
-1778969928,Burgers,1,1972879238,759552160:380220741:385684499,True,False,0,-2,3\r
1551533879,Turkey,1,-1706154991,-1506824829:380220741,True,False,0,1,5\r
-133939790,Pies,1,-1706154991:-523839730,925796718:-484165118:-266993023:380220741,True,False,0,1,8\r
1113735761,Cakes,0,-1706154991:-523839730:1972879238,-1723125645:961148621:925796718:-217313684:-2133205155:783588616,False,False,0,0,3\r
1764920765,Spaghetti,1,1972879238:2087693779,-182748008:-266993023:-957949759:380220741:-712909563,True,False,0,1,5\r
1743900205,Fish,1,1972879238,-609358791:380220741:-1735137431,True,False,0,1,5\r
506626805,Tacos,1,2087693779:1972879238,-5840756:-1541798751:745886540,True,False,0,-1,1\r
1626323920,Hot Dogs,1,1972879238,-1132411297:380220741:1799769627:-965827229,True,False,0,-1,5\r
-2075899,Breakfast,1,-523839730:-1706154991,380220741:925796718,True,False,0,0,5\r
-1653221873,Stir Fry,1,2087693779:1972879238,-452101383:-1573812073:380220741:-1201769154:314862254,True,False,0,1,10\r
`;const I=R.trim().split(`\r
`).filter(t=>t).map(t=>{var x,V;const[e,r,s,a,n,i,u,l,c,o,F,p]=t.split(","),m=Number(e),h=Number(s),f=a!=null&&a.length?a.split(":").map(w=>Number(w)):[],d=n.length?n.split(":").map(w=>Number(w)):[],k=i!=null&&i.length?(x=i==null?void 0:i.split(":"))==null?void 0:x.map(w=>Number(w)):[],D=u!=null&&u.length?(V=u==null?void 0:u.split(":"))==null?void 0:V.map(w=>Number(w)):[],M=l==="True",y=c==="True",C=Number(o),P=Number(F),E=Number(p);return{ID:m,Name:r,UnlockGroup:h,Requires:f,BlockedBy:d,RequiredProcesses:k,IngredientProviders:D,isMain:M,isStarterOrSide:y,DishType:C,CustomerMultiplier:P,DishValue:E}});function v(t,e=!0){const r=e&&t.some(s=>s.Name==="Community");return I.filter(s=>{if(t.some(a=>a.ID===s.ID)||s.BlockedBy.some(a=>t.some(n=>n.ID===a))||s.Requires.some(a=>!t.some(n=>n.ID===a)))return!1;if(s.isStarterOrSide)if(t.some(a=>a.isMain)){if(t.length&&t[0].DishType===g.Dessert)debugger}else return!1;return!(!r&&s.DishType===g.Base)}).sort((s,a)=>s.ID-a.ID)}const _=[...[{ID:447437163,Name:"Country",UnlockGroup:b.Special,Requires:[],BlockedBy:[],RequiredProcesses:[],IngredientProviders:[],isMain:!1,isStarterOrSide:!1,DishType:g.Null,CustomerMultiplier:0,DishValue:0},{ID:2002876295,Name:"City",UnlockGroup:b.Special,Requires:[],BlockedBy:[],RequiredProcesses:[],IngredientProviders:[],isMain:!1,isStarterOrSide:!1,DishType:g.Null,CustomerMultiplier:0,DishValue:0},{ID:-1864906012,Name:"Alpine",UnlockGroup:b.Special,Requires:[],BlockedBy:[],RequiredProcesses:[],IngredientProviders:[],isMain:!1,isStarterOrSide:!1,DishType:g.Null,CustomerMultiplier:0,DishValue:0},I.filter(t=>t.Name==="Community")[0],I.filter(t=>t.Name==="Couples")[0],{ID:1958825350,Name:"Turbo",UnlockGroup:b.Special,Requires:[],BlockedBy:[],RequiredProcesses:[],IngredientProviders:[],isMain:!1,isStarterOrSide:!1,DishType:g.Null,CustomerMultiplier:0,DishValue:0},I.filter(t=>t.Name==="Christmas Rush")[0]]].slice(3).sort((t,e)=>t.Name<e.Name?-1:1);["Breakfast","Burgers","Hot Dogs","Fish","Pies","Salad","Stir Fry","Pizza","Turkey"].map(t=>I.filter(e=>e.Name===t)[0]);const Z=K.trim().split(`\r
`).filter(t=>t).map(t=>{var y,C;const[e,r,s,a,n,i,u,l,c,o]=t.split(","),F=Number(e),p=Number(s),m=a!=null&&a.length?(y=a==null?void 0:a.split(":"))==null?void 0:y.map(P=>Number(P)):[],h=n!=null&&n.length?(C=n==null?void 0:n.split(":"))==null?void 0:C.map(P=>Number(P)):[],f=i==="True",d=u==="True",k=Number(l),D=Number(c),M=Number(o);return{ID:F,Name:r,UnlockGroup:p,Requires:[],BlockedBy:[],RequiredProcesses:m,IngredientProviders:h,isMain:f,isStarterOrSide:d,DishType:k,CustomerMultiplier:D,DishValue:M}}).sort((t,e)=>t.Name<e.Name?-1:1),O={};for(const t of I)O[t.Name]=t;for(const t of Z)O[t.Name]=t;for(const t of _)O[t.Name]=t;class G{constructor(e,r){T(this,"fixedSeed");T(this,"instance");T(this,"random");typeof e=="string"&&(e=X(e)),this.fixedSeed=e,this.instance=r,this.random=new H(e+Math.imul(124192293,r))}useSubcontext(e){return new G(this.fixedSeed,124192293*e+this.instance)}}class H{constructor(e){T(this,"seed");const r=u=>Math.imul(1812433253,u)+1>>0,s=e>>0,a=r(s),n=r(a),i=r(n);this.seed=[s,a,n,i]}get value(){let e=this.seed.shift(),r=this.seed[2];return e^=e<<11,e^=e>>>8,r^=r>>>19,r=(r^e)>>0,this.seed.push(r),r}range(e,r){return(this.value>>>0)%(r-e)+e}get valueFloat(){return(this.value<<9>>>0)/4294967295}select(e){return e[this.range(0,e.length)]}}function X(t){const r=new TextEncoder().encode(t);let s=5381,a=r.length;for(;a--;)s=(s<<5)+s+r[a];return s>>0}function j(t,e,r){return new G(r,t*1231231+e)}class q{constructor(){T(this,"encourageGroups",[b.Special])}GetOptions(e,r,s){const a=s.random;let n=0;for(r!==15&&(n=this.getPad(e,r));n--;)a.value;let i=this.sortCandidates(e,r,s.random);const[u,l]=this.getUnlockGroups(r);let c=null,o=null;for(const F of i)if(!(F.UnlockGroup!==u&&F.UnlockGroup!==l)&&(c===null||c.UnlockGroup!==u&&F.UnlockGroup===u?c=F:(o===null||o.UnlockGroup!==l&&F.UnlockGroup===l)&&(o=F),c&&c.UnlockGroup===u&&o&&o.UnlockGroup===l))break;return[c,o]}getPad(e,r){if(r===15)return 0;let s=v(e).length+1;return r===5&&(s*=2),s}getCandidates(e,r){return v(e)}sortCandidates(e,r,s){let a=this.getCandidates(e,r),n=A(a,s);return s.valueFloat<.5&&n.sort((u,l)=>{let c=0;return z(u)&&c--,z(l)&&c++,c}),n}getUnlockGroups(e){return e===15?[b.Franchise,b.Franchise]:e===5?[b.PrimaryTheme,b.PrimaryTheme]:[b.Dish,b.Generic]}}class $ extends q{getPad(e,r){let s=v(e,!1).length+1;return r!==5&&(s*=2),s}sortCandidates(e,r,s){let a=this.getCandidates(e,r),n=A(a,s);return s.valueFloat<.1&&n.sort((l,c)=>{let o=0;return l.Requires.length&&o--,c.Requires.length&&o++,o}),n}}class ee extends q{constructor(){super(...arguments);T(this,"ThanksgivingCards",["Turkey","Nut Roast"])}getPad(r,s){if(s===15)return 0;let a=v(r,!1).length+1;if(s===5){let n=v(r);a+=n.length+2}return a}getCandidates(r,s){return s===5||s===15?v(r,!1):v(r)}sortCandidates(r,s,a){let n=this.getCandidates(r,s),i=A(n,a);return a.valueFloat<.5&&i.sort((c,o)=>{let F=0;return z(c,!1)&&F--,z(o,!1)&&F++,F}),s!==5&&s!==15&&a.valueFloat<.25&&i.sort((o,F)=>{let p=0;return this.ThanksgivingCards.includes(o.Name)&&p++,this.ThanksgivingCards.includes(F.Name)&&p--,p}),i}getUnlockGroups(r){return r===15?[b.Franchise,b.Franchise]:r===5?[b.PrimaryTheme,b.PrimaryTheme]:[b.Dish,b.Dish]}}function A(t,e){return t.map(s=>[s,e.valueFloat]).sort((s,a)=>s[1]-a[1]).map(s=>s[0])}class se{constructor(e){T(this,"cards");T(this,"unlockPack");T(this,"seed");this.cards=[],this.unlockPack=new q,this.seed=e}addCard(e){if(e!==void 0){switch(e.Name){case"Community":this.unlockPack=new ee;break;case"Turbo":this.unlockPack=new $;break}this.cards.push(e)}}getUnlockOptions(e){const s=j(848292,e,this.seed).useSubcontext(1);return this.unlockPack.GetOptions(this.cards,e,s)}getCustomers(e,r=1){return[]}getGroupSizeRange(e){if(this.cards.some(n=>n.Name==="Community")){const n=Math.floor((e-1)/3);return[n+1,n+2]}let s=1,a=2;return this.cards.some(n=>n.Name==="Individual Dining")?[1,1]:(this.cards.some(n=>n.Name==="Medium Groups")&&(s++,a+=2),this.cards.some(n=>n.Name==="Large Groups")&&(s+=2,a+=4),this.cards.some(n=>n.Name==="Flexible Groups")&&(s--,a++),[s,a])}}function z(t,e=!0){return t.UnlockGroup===b.Special||t.DishType===g.Main||t.DishType===g.Extra?!0:e?!!t.Requires.length:!1}const re="12345678",Q="bdghjmqrtvwxy346789",te="1c,1d,1e,1f,1g,1h,1i,1j,1k,1l,1m,1n,1o,1p,1q,1r,1s,1t,1u,1v,1w,1x,1y,1z,13,14,15,16,17,18,19,2c,2d,2e,2f,2g,2h,2i,2j,2k,2l,2m,2n,2o,2p,2q,2r,2s,2t,2u,2v,2w,2x,2y,2z,23,24,25,26,27,28,29,3c,3d,3e,3f,3g,3h,3i,3j,3k,3l,3m,3n,3o,3p,3q,3r,3s,3t,3u,3v,3w,3x,3y,3z,33,34,35,36,37,38,39,4c,4d,4e,4f,4g,4h,4i,4j,4k,4l,4m,4n,4o,4p,4q,4r,4s,4t,4u,4v,4w,4x,4y,4z,43,44,45,46,47,48,49,5c,5d,5e,5f,5g,5h,5i,5j,5k,5l,5m,5n,5o,5p,5q,5r,5s,5t,5u,5v,5w,5x,5y,5z,53,54,55,56,57,58,59,6c,6d,6e,6f,6g,6h,6i,6j,6k,6l,6m,6n,6o,6p,6q,6r,6s,6t,6u,6v,6w,6x,6y,6z,63,64,65,66,67,68,69,7c,7d,7e,7f,7g,7h,7i,7j,7k,7l,7m,7n,7o,7p,7q,7r,7s,7t,7u,7v,7w,7x,7y,7z,73,74,75,76,77,78,79,8c,8d,8e,8f,8g,8h,8i,8j,8k,8l,8m,8n,8o,8p,8q,8r,8s,8t,8u,8v,8w,8x,8y,8z,83,84,85,86,87,88,89".split(",");for(const t of te);for(const t of re);function ae(){let t="";for(;t.length<8;)t+=Q[Math.floor(Math.random()*Q.length)];return t}function B(t){return t.length?t.reduce((e,r)=>e+r,0)/t.length:0}const U={};function L(t){const{starters:e,main:r,doubleOrderChance:s,desserts:a,sides:n,groupSizes:i}=t,u=[e,r,s,a,[...i].sort((h,f)=>h-f)].join("|");if(U[u])return U[u];let l=[0,0,0],c=[0,0,0,0],o=1-.75**n;if(e>0){l[0]=1;let h=1-.75**e;s===.5&&(h*=1.25,o*=1.25),c[0]=i.reduce((f,d)=>f+1+(d-1)*h,0)}const F=i.reduce((h,f)=>h+f);r&&(l[1]=1,c[1]=F),a>0&&(c[2]=F,r?(l[2]=1-.75**a,s===.5&&(l[2]*=1.25)):l[2]=1);let p=1;e>0&&(l[0]*=1+s,p*=1-s,c[0]*=l[0]),r&&(l[1]*=1+p*s,p*=1-s,c[1]*=l[1],c[3]=c[1]*o),a>0&&(l[2]*=1+p*s,p*=1-s,c[2]*=l[2]);const m=[l.map(h=>h*i.length),c];return U[u]=m,m}function ne(t){const{starters:e,main:r,doubleOrderChance:s,desserts:a,sides:n,groupSizes:i}=t;let u=[0,0,0],l=[0,0,0,0],c=1-.75**e,o=1-.75**a,F=1-.75**n;s===.5&&(c*=1.25,o*=1.25,F*=1.25);const p=d=>{u[0]++,l[0]++;for(let k=0;k<d-1;k++)Math.random()<c&&l[0]++},m=d=>{u[1]++,l[1]+=d;for(let k=0;k<d;k++)Math.random()<F&&l[3]++},h=d=>{u[2]++,l[2]+=d};for(const d of i){let k=!1;e>0&&(p(d),!k&&Math.random()<s&&(k=!0,p(d))),m(d),!k&&Math.random()<s&&(k=!0,m(d)),a>0&&Math.random()<o&&(h(d),!k&&Math.random()<s&&(k=!0,h(d)))}return[u,l]}const ie={"Diner (1)":1,"Small (2)":2,"Medium (2)":2,"Large (3)":3,"Huge (4)":4},W={};["Morning Rush","Lunch Rush","Dinner Rush"].forEach(t=>W[t]=!0);class le{constructor(e,r=[],s=[]){T(this,"seed");T(this,"mapSize");T(this,"frontDoor");T(this,"startingCards");T(this,"cards");T(this,"playerCount");T(this,"turbo");T(this,"_actionInfoCacheByCards",{});T(this,"_cardsByDay",[]);this.seed=e,this.mapSize=this.getMapSize(),this.frontDoor=this.getDoorInfo(),this.startingCards=r,this.cards=s,this.playerCount=ie[this.mapSize],this.turbo=this.startingCards.some(a=>{if(a===void 0){console.log({startingCards:r});debugger}return a.Name==="Turbo"})}guessMoney(e){if(e===0)return this.turbo?30:0;const r=this.getCardsByDay(e),s=this.getGroupSizes(e);let a=!1,n=!1,i=0,u=[],l=[],c=0,o=[],F=0,p=[];for(const C of r)switch(C.Name==="All You Can Eat"&&(a=!0),C.Name==="Double Helpings"&&(n=!0),C.DishType){case g.Dessert:c++,C.DishValue&&o.push(C.DishValue);break;case g.Starter:C.DishValue&&u.push(C.DishValue),i++;break;case g.Side:C.DishValue&&p.push(C.DishValue),F++;break;case g.Main:case g.Base:C.Name==="Tacos"?(l.push(2),l.push(3)):C.DishValue&&l.push(C.DishValue)}let m=n?.5:a?.25:0,h=[0,0,0,0];if(h[0]=B(u),h[1]=B(l),h[2]=B(o),h[3]=B(p),n)for(let C=0;C<3;C++)h[C]&&(h[C]+=3);const[f,d]=L({starters:i,main:!!h[1],doubleOrderChance:m,desserts:c,sides:F,groupSizes:s});let k=0;for(let C=0;C<d.length;C++)k+=d[C]*h[C];const D=Y(this.playerCount),M=this.getBookingDeskCount(e),y=this.getBookingDeskMoney(e);return D*(k+M*y)}courseInfo(e){if(e===0)return[[0,0,0],[0,0,0,0]];const r=this.getCardsByDay(e),s=this.getGroupSizes(e);let a=!1,n=!1,i=0,u=[],l=[],c=0,o=[],F=0,p=[];for(const d of r)switch(d.Name==="All You Can Eat"&&(a=!0),d.Name==="Double Helpings"&&(n=!0),d.DishType){case g.Dessert:c++,d.DishValue&&o.push(d.DishValue);break;case g.Starter:d.DishValue&&u.push(d.DishValue),i++;break;case g.Side:d.DishValue&&p.push(d.DishValue),F++;break;case g.Main:case g.Base:d.Name==="Tacos"?(l.push(2),l.push(3)):d.DishValue&&l.push(d.DishValue)}let m=n?.5:a?.25:0,h=[0,0,0,0];if(h[0]=B(u),h[1]=B(l),h[2]=B(o),h[3]=B(p),n)for(let d=0;d<3;d++)h[d]&&(h[d]+=3);return L({starters:i,main:!!h[1],doubleOrderChance:m,desserts:c,sides:F,groupSizes:s})}actionInfo(e){if(e===0)return 0;const r=this.getCardsByDay(e),s=e.toString()+":"+r.map(S=>S.Name).sort().join(","),a=this._actionInfoCacheByCards[s];if(a)return a;let n=0;const i={Breakfast:6,Dumplings:11.25,"Stir Fry":26/2,Steak:7};let u=0;for(let S=0;S<r.length;S++)if(r[S].DishType!==g.Null){const N=r[S].Name;u=i[N]??20;break}let l=-1,c=[1,1,1],o=[[],[u],[],[]],F=0;const p=this.getGroupSizes(e);let m=!1,h=!1,f=0,d=[],k=[],D=0,M=[],y=0,C=[],P=!1,E=!1;for(const S of r){switch(S.Name==="All You Can Eat"&&(m=!0),S.Name==="Double Helpings"&&(h=!0),S.Name){case"Picky Eaters":P=!0;break;case"Leisurely Eating":E=!0,F+=2;break;case"Instant Service":for(let N=0;N<3;N++)c[N]--;break;case"Ice Cream":o[2].push(5.125);break;case"Cheese Board":o[2].push(10);break;case"Cherry Pie":o[2].push(11);break;case"Apple Pies":o[2].push(15);break;case"Pumpkin Pies":o[2].push(16);break;case"Carrot Soup":case"Meat Soup":o[0].push(7);break;case"Tomato Soup":case"Pumpkin Soup":c[0]=4,o[0].push(8);break;case"Broccoli Cheese Soup":o[0].push(5),c[0]=4;break;case"Pumpkin Seed":o[0].push(3*8);break;case"Bread":o[0].push(5*3);break;case"Mandarin Starter":o[0].push(7*3);break;case"Mashed Potato":case"Broccoli":case"Bamboo":o[3].push(2);break;case"Onion Rings":o[3].push(8);break;case"Corn on the Cob":o[3].push(6);break;case"Chips":o[3].push(7);break;case"Roast Potato":o[3].push(4);break}switch(S.DishType){case g.Dessert:D++,S.DishValue&&M.push(S.DishValue);break;case g.Starter:S.DishValue&&d.push(S.DishValue),f++;break;case g.Side:S.DishValue&&C.push(S.DishValue),y++;break;case g.Main:case g.Base:S.Name==="Tacos"?(k.push(2),k.push(3)):S.DishValue&&k.push(S.DishValue);break;case g.Extra:S.Name==="Seaweed"?(o[1][0]+=1.75,l+=2):S.Name==="Dumpling - Soy Sauce"?o[1][0]+=.4:S.Name==="Breakfast Beans"?o[1][0]+=1+3/4:S.Name==="Breakfast Eggs"?o[1][0]+=6:S.Name==="Breakfast Extras"&&(l++,o[1][0]+=1.5*2),l++;break}}e>6&&(o[3]=[]),P&&(E&&!m||(o[1][0]+=2,l++));let x=h?.5:m?.25:0;n+=p.length*F;const[V,w]=L({starters:f,main:!0,doubleOrderChance:x,desserts:D,sides:y,groupSizes:p});V.forEach((S,N)=>n+=S*c[N]);for(const S of o)for(let N=0;N<S.length;N++)l>0&&(S[N]+=l),l+=1;return w.forEach((S,N)=>{var J;if((J=o[N])!=null&&J.length){if(!N){const Ce=Math.ceil(S/o[N].length/3);n+=Ce*o[N].reduce((Se,De)=>Se+De,0);return}n+=S*B(o[N])}}),this._actionInfoCacheByCards[s]=n,n}simulateMoney(e){if(e===0)return this.turbo?30:0;const r=this.getCardsByDay(e),s=this.getGroupSizes(e);let a=!1,n=!1,i=[[],[],[],[]];for(const f of r)switch(f.Name==="All You Can Eat"&&(a=!0),f.Name==="Double Helpings"&&(n=!0),f.DishType){case g.Dessert:f.DishValue&&i[2].push(f.DishValue);break;case g.Starter:f.DishValue&&i[0].push(f.DishValue);break;case g.Side:f.DishValue&&i[3].push(f.DishValue);break;case g.Main:case g.Base:f.Name==="Tacos"?(i[1].push(2),i[1].push(3)):f.DishValue&&i[1].push(f.DishValue)}let u=n?.5:a?.25:0,l=0;n&&(l+=3);const[c,o]=ne({starters:i[0].length,main:!!i[1].length,doubleOrderChance:u,desserts:i[2].length,sides:i[3].length,groupSizes:s});let F=0;for(let f=0;f<o.length;f++){let d=o[f];for(;d--;)f<3&&(F+=l),F+=i[f][Math.floor(Math.random()*i[f].length)]}const p=Y(this.playerCount),m=this.getBookingDeskCount(e),h=this.getBookingDeskMoney(e);return p*(F+m*h)}getBookingDeskMoney(e){return Math.ceil((e+1)/2)+2}getCardsByDay(e){if(this._cardsByDay[e]===void 0){let r;this.turbo?r=e-1:(r=Math.max(0,Math.floor((e-1)/3)),e>5&&r++),this._cardsByDay[e]=[...this.startingCards,...this.cards.slice(0,r)]}return this._cardsByDay[e]}getBookingDeskCount(e,r=1){const s=Math.ceil(this.getExpectedCustomers(e)/this.getExpectedGroupSize(e));if(this.getCardsByDay(e).some(c=>c.Name==="Herd Mentality"))return Math.min(s,3)+1;const a=[],n=this.getCardsByDay(e);let i=1;(this.turbo||n.some(c=>c.Name==="Morning Rush"))&&(a.push(.2),i++),(this.turbo||n.some(c=>c.Name==="Lunch Rush"))&&(a.push(.5),i++),(this.turbo||n.some(c=>c.Name==="Dinner Rush"))&&(a.push(.8),i++);const u=r/this.getDayLength(e),l=.1/s;for(let c=1;c<s;c++){const o=c/s,F=o-l-u,p=o+l+u;let m=!1;for(const h of a)if(F<=h&&p>=h){m=!0;break}m||i++}return i}getNonRushGroupCount(e){const r=this.getExpectedCustomers(e),s=this.getCardsByDay(e).filter(i=>i.Name==="Closing Time?").length*.2,a=this.getExpectedGroupSize(e),n=r*(1+s)/a;return Math.ceil(n)}getCustomerCount(e){return this.getGroupSizes(e).reduce((r,s)=>r+s,0)}getGroupSizes(e){const r=this.seed?j(1997821,e,this.seed).random:new H(Math.floor(Math.random()*4294967295)),s=this.getNonRushGroupCount(e),a=this.getCardsByDay(e).some(p=>p.Name==="Herd Mentality");let n=s,i=[],[u,l]=this.getGroupSizeRange(e);!this.seed||this.seed==="_min"?l=u:this.seed==="_max"&&(u=l);{let p=n-1;for(;p--;)r.value}for(;n--;)i.push(r.range(u,l+1)),!a&&n!==s-1&&r.value;let c=this.turbo?3:this.getCardsByDay(e).filter(p=>W[p.Name]).length;const o=Math.ceil(Math.max(1,this.getExpectedCustomers(e)*.15));let F=c*o;for(;F--;)i.push(r.range(u,l+1));if(!this.seed||this.seed[0]==="_"){let p=u;for(let m=0;m<i.length;m++)i[m]=p,p++,p>l&&(p=u)}return i}getExpectedGroupSize(e){const r=this.getGroupSizeRange(e);return(r[0]+r[1])/2}getGroupSizeRange(e){let r=1,s=2;for(const a of this.getCardsByDay(e))switch(a.Name){case"Individual Dining":s--;break;case"Medium Groups":r++,s+=2;break;case"Large Groups":r+=2,s+=2;break;case"Flexible Dining":r--,s++;break;case"Community":const n=Math.floor((e-1)/3);r+=n,s+=n;break}return[r,s]}getExpectedCustomers(e){const r=this.getReductions(e),s=this.getDayLength(e),a=this.getPlayerModifier(),n=this.getCourseModifier(e),i=this.getDayRate(e),u=this.getCustomersPerHour(e),l=this.getAdvertisingModifier(e);return .85**r*(s/25*i*a)/n*u*l}getAdvertisingModifier(e){return 1+.25*this.getCardsByDay(e).filter(s=>s.Name==="Advertising").length}getDayRate(e){let r=1;switch(e){case 1:r=1.25;break;case 2:r=1.5;break;default:r=1.5+.15*(e-3);break}return e>15&&(r+=(this.turbo?.1:0)*(e-15)**1.5),r}getCourseModifier(e){let r=1;const s=this.getCardsByDay(e);return s.some(a=>a.DishType===g.Dessert||a.Name==="Black Coffee"||a.Name==="Cakes")&&(r+=.25),s.some(a=>a.DishType===g.Starter)&&(r+=.25),r}getPlayerModifier(){let e;switch(this.playerCount){case 0:e=1;break;case 1:e=.8;break;case 2:e=1;break;case 3:e=1.25;break;default:e=1.5;break}return e}getDayLength(e){return 100+Math.floor(e/3)*25}getCustomersPerHour(e){let r=1;return this.turbo&&(r=1.5,r*=1+e/10),r}getReductions(e){return this.getCardsByDay(e).reduce((s,a)=>s+a.CustomerMultiplier,0)}getMapSize(){const r=new G(this.seed,5078598).useSubcontext(0).random.range(0,8);let s;switch(r){case 0:s="Small (2)";break;case 4:s="Medium (2)";break;case 1:case 5:s="Diner (1)";break;case 2:case 6:s="Large (3)";break;case 3:case 7:s="Huge (4)";break;default:throw new Error}return s}getLayoutInfo(){const r=new G(this.seed,5078598).useSubcontext(0).random.range(0,8);let s,a;switch(r){case 0:a=70,s=2;break;case 4:a=84,s=2;break;case 1:case 5:a=60,s=1;break;case 2:case 6:a=9*13,s=3;break;case 3:case 7:a=12*16,s=4;break;default:throw new Error}return[s,a]}getDoorInfo(){if(this.mapSize!=="Diner (1)")return-1;let e=new H(new G(this.seed,98234234).useSubcontext(0).random.value),r=23;for(;r--;)e.value;return e.range(0,4)}}function Y(t){switch(t){case 1:return 1.25;case 2:return 1.1;default:return 1}}_.filter(t=>t.Name==="Community")[0],I.filter(t=>t.Name==="Salad")[0];const oe=[3,5,6,9,12],ue=[1,2,3,4,5,6,7,8,9,10,11,12,13,14],ce=self;ce.onmessage=t=>{let e;const{allowedTables:r,startingDishes:s,mapSettings:a}=t.data.data,n=[...s],i=new se(""),u=a.some(l=>l.Name==="Turbo");if(u)debugger;for(const l of a)i.addCard(l);switch(t.data.type){case"strict":e=fe;break;case"flex":e=Fe;break;case"priorityModel":let l=!1;a.some(c=>c.Name==="Community")&&(l=!0),l?e=ge:e=pe;break;default:throw new Error}for(;n.length;){const l=ae(),c=new le(l).getMapSize();if(!r.includes(c))continue;i.seed=l;const o=Math.floor(Math.random()*n.length);i.cards=[...a,n[o]],e(i,u?ue:oe)&&(he({seed:l,mapSize:c,startingDish:n[o].Name}),n.splice(o,1))}};function he(t){de({type:"result",data:t})}function de(t){postMessage(t)}function fe(t,e){let r=[t.cards];for(let s=0;s<e.length;s++){const a=new Set;let n=[];for(const i of r){t.cards=i;const u=t.getUnlockOptions(e[s]);if(a.add(u[0].Name),a.add(u[1].Name),a.size>2)return!1;n.push([...i,u[0]]),n.push([...i,u[1]])}r=n}return!0}function Fe(t,e){let r=[t.cards];const s=new Set;for(let a=0;a<e.length;a++){let n=[];for(const i of r){t.cards=i;const u=t.getUnlockOptions(e[a]);if(s.add(u[0].Name),s.add(u[1].Name),s.size>10)return!1;n.push([...i,u[0]]),n.push([...i,u[1]])}r=n}return!0}function pe(t,e){let s=[t.cards],a={};for(let n=0;n<e.length;n++){let i=[[[]],[[]]],u=[new Set,new Set],l=[new Map,new Map],c=[];for(let o=0;o<s.length;o++){const F=s[o];t.cards=F;const p=e[n],m=t.getUnlockOptions(p);if(p===5){for(const h of[0,1]){u[0].add(m[h].ID);const f=[...F,m[h]],d=f.map(k=>k.ID).sort((k,D)=>k-D).join(",");a[d]||(a[d]=!0,c.push(f))}if(u[0].size>2)return!1;continue}for(let h=0;h<=1;h++){const f=m[h],d=[...F,f],k=d.map(D=>D.ID).sort((D,M)=>D-M).join(",");if(a[k]?console.log("prevented dupe path"):(a[k]=!0,c.push(d)),l[h].set(F,f),!u[h].has(f.ID)){u[h].add(f.ID),i[h]=i[h].flatMap(D=>{let M=[];for(let y=0;y<=D.length;y++){const C=[...D];C.splice(y,0,f),M.push(C)}return M});for(let D=0;D<i[h].length;D++){const M=i[h][D];let y=!0;for(let C=0;C<=o;C++){const P=s[C],E=me(t,p,P,M),x=l[h].get(P);if((x==null?void 0:x.ID)!==E.ID){y=!1;break}}y||(i[h].splice(D,1),D--)}if(!i[h].length)return!1}}}s=c}return!0}function ge(t,e){let s=[t.cards];for(let a=0;a<e.length;a++){let n=[[]],i=new Set,u=new Map,l=[];for(let c=0;c<s.length;c++){const o=s[c];t.cards=o;const F=e[a],p=t.getUnlockOptions(F);u.set(o,p);for(let m=0;m<=1;m++){const h=p[m];l.push([...o,h]),!i.has(h.ID)&&(i.add(h.ID),n=n.flatMap(f=>{let d=[];for(let k=0;k<=f.length;k++){const D=[...f];D.splice(k,0,h),d.push(D)}return d}))}for(let m=0;m<n.length;m++){const h=n[m];let f=!0;for(let d=0;d<=c;d++){const k=s[d],D=ke(t,F,k,h),M=u.get(k);if(!D.some(y=>y.ID===M[0].ID)||!D.some(y=>y.ID===M[1].ID)){f=!1;break}}f||(n.splice(m,1),m--)}if(!n.length)return!1}s=l}return!0}function me(t,e,r,s){const a=t.unlockPack.getCandidates(r,e);for(const n of s)if(a.some(i=>i.ID===n.ID))return n;throw new Error("no valid options")}function ke(t,e,r,s){const a=t.unlockPack.getCandidates(r,e),n=[];for(const i of s)if(a.some(u=>u.ID===i.ID)&&(n.push(i),n.length===2))return n;throw new Error("not enough valid options")}})();
