import{u as e,q as O,g as $}from"./jsxRuntime.module-cxiL4QXa.js";import{h as m,F as V,p as K}from"./compat.module-Hy7tfJQd.js";import{A as B,S as L,G as M}from"./GhostBlueprints-dEWhyOYs.js";import{u as x,a as S,U}from"./UnlockSelect-qKChER4O.js";import{V as E}from"./Version-cwXygF80.js";import"./prng-1rWzft78.js";import"./unlocks-8mfgXCLy.js";const R=a=>{const[r,c]=m(a);return[r,s=>{c(s.target.value)}]},G=[...B];function q(a,r,c){const t=r.toLowerCase();return G.filter(function(l){return!a.some(d=>d.ID===l.ID)&&l.Name.toLowerCase().includes(t)&&(!c||l.StapleWhenMissing)})}function z({onSelectionChange:a,label:r,placeholder:c,include:t=!0,appliances:s=[],stapleRelatedOnly:l=!0}){const[d,f]=m(""),C=V(()=>q(s,d,l),[s,d]),{getSelectedItemProps:v,getDropdownProps:N,removeSelectedItem:y}=x({selectedItems:s,onStateChange({selectedItems:i,type:o}){switch(o){case x.stateChangeTypes.SelectedItemKeyDownBackspace:case x.stateChangeTypes.SelectedItemKeyDownDelete:case x.stateChangeTypes.DropdownKeyDownBackspace:case x.stateChangeTypes.FunctionRemoveSelectedItem:a(i??[]);break}}}),{isOpen:h,getToggleButtonProps:g,getLabelProps:b,getMenuProps:I,getInputProps:p,highlightedIndex:k,getItemProps:n,selectedItem:w}=S({items:C,itemToString(i){return i?i.Name:""},defaultHighlightedIndex:0,selectedItem:null,inputValue:d,stateReducer(i,o){const{changes:u,type:D}=o;switch(D){case S.stateChangeTypes.InputKeyDownEnter:case S.stateChangeTypes.ItemClick:return{...u,isOpen:!0,highlightedIndex:0};default:return u}},onStateChange({inputValue:i,type:o,selectedItem:u}){switch(o){case S.stateChangeTypes.InputKeyDownEnter:case S.stateChangeTypes.ItemClick:case S.stateChangeTypes.InputBlur:u&&(a([...s,u]),f(""));break;case S.stateChangeTypes.InputChange:f(i??"");break}}});return e("div",{className:"combo-container",children:[e("div",{className:"",children:[e("label",{className:"",...b(),children:r??"Select desired cards"}),e("div",{className:"",children:[s.map(function(o,u){return e("span",{className:"selected-items"+(t?" include":" exclude"),...v({selectedItem:o,index:u}),children:[o.Name,e("span",{class:"x",onClick:D=>{D.stopPropagation(),y(o)},children:"âœ•"})]},`selected-item-${u}`)}),e("div",{className:"",children:e("input",{placeholder:c??"Card Selection(s)",className:"",...p(N({preventKeyAction:h}))})})]})]}),e("ul",{className:`dropdown ${h&&C.length?"":"hidden"}`,...I(),children:[!1,h&&C.map((i,o)=>e("li",{className:F(k===o&&"bg-blue-300",w===i&&"font-bold","py-2 px-3 shadow-sm flex flex-col"),...n({item:i,index:o}),children:e("span",{children:i.Name})},`${i.ID}${o}`))]})]})}const F=(...a)=>a.filter(r=>r).join(" ");function H(a){let r="";if(!a.length)r="Spawn: any settings";else{for(let t=0;t<a.length;t++){const s=a[t];let l=t?`Reroll ${t}`:"Spawn";l+=": ",l+="Blueprints "+(s.spawnInside?"Spawn Inside":"Spawn Outside, "+(s.playerInside?"Someone Inside":"All Players Stand Outside")),t&&(l+=`, reroll ${a[t].blueprintCount} blueprints`),r+=l+`
`}r+=`Reroll ${a.length}: any settings`}const c=r.split(`
`);return e("div",{class:"reroll-instructions",onClick:t=>{if(console.log(t.detail),t.detail<2)return;const s=document.createRange();s.selectNodeContents(t.currentTarget);const l=document.getSelection();l==null||l.removeAllRanges(),l==null||l.addRange(s)},children:c.map(t=>e("div",{children:t}))})}const _=({seed:a,day:r,startingConfig:c=[],baseUpgradeChance:t=0,blueprintCount:s=5,searchDepth:l=2,ghostBlueprints:d=2,blueprintCabinets:f=1,solo:C,cards:v=[],appliances:N=[]})=>{var k;a=a.toLocaleLowerCase().trim();const y={blueprintCount:s+d,spawnInside:!0},h=new L(a,t);for(const n of v)h.addCard(n);h.OwnedAppliances=[...h.OwnedAppliances,...N];const g=[],b=[];for(let n=-f-1;n<=f;n++){const w={spawnInside:!0,blueprintCount:s+n};g.push(w),C||g.push({spawnInside:!1,playerInside:!0,blueprintCount:s+n}),g.push({spawnInside:!1,playerInside:!1,blueprintCount:s+n}),n===0&&(b.push(w),b.push({spawnInside:!1,playerInside:!0,blueprintCount:s+n}),b.push({spawnInside:!1,playerInside:!1,blueprintCount:s+n}))}let I=[],p=[c];for(let n=0;n<=l;n++){let w=[],i=[];for(let o=0;o<p.length;o++){const u={...y};u.blueprintCount=p[o].length?(((k=p[o].at(-1))==null?void 0:k.blueprintCount)??s)+d:s;const D=h.getAppliances([...p[o],u],r).map(T=>T.Name);i.push(e("td",{class:"reroll-cell",colspan:g.length**(l-n),children:[e(M,{bps:D,ghostCount:n===0?0:d}),H(p[o])]}));const P=c.length+n===0?b:g;for(const T of P){const A=[...p[o],T];w.push(A)}}I.push(e("tr",{children:[e("td",{children:n?`Reroll ${n}`:"Spawns"}),i]})),p=w}return e("table",{children:[" ",I," "]})},j=({onConfigChange:a})=>{const[r,c]=m(2),[t,s]=R("az"),[l,d]=R("2"),[f,C]=m(5),[v,N]=m(0),[y,h]=m(!1),[g,b]=m([B.filter(n=>n.Name==="Blueprint Cabinet")[0]]),[I,p]=m([]),k=n=>{n.target.checked?(C(7),N(.25)):(C(5),N(0))};return K(()=>{a({seed:t,day:Number(l)-1,initialRerollConfig:[],blueprintCount:f,baseUpgradeChance:v,solo:y,appliances:g,cards:I,searchDepth:r})},[t,l,f,v,y,g,I,r]),e("div",{children:[e("div",{children:[e("div",{children:"Run Config:"}),e("label",{for:"solo",children:"Solo:"}),e("input",{type:"checkbox",id:"solo",checked:y,onChange:()=>h(n=>!n)}),e("label",{for:"searchDepth",children:"Number of Rerolls"})," ",e("input",{id:"searchDepth",type:"number",value:r,onChange:n=>c(Number(n.target.value))}),e("br",{}),e("label",{for:"seed",value:t,children:["Seed:"," "]}),e("input",{type:"text",id:"seed",value:t,onChange:s}),e("label",{for:"setting",children:"Turbo?"}),e("input",{id:"setting",type:"checkbox",checked:f===7,onChange:k})]}),e("div",{children:[e("label",{for:"day",value:l,children:["Prep of Day:"," "]}),e("input",{type:"number",id:"day",value:l,onChange:d}),e(U,{label:"Selected cards:",onSelectionChange:n=>{p(n.cards)},showSelectionMode:!1,cards:I,include:!0,modes:["themes","dishes"]}),e(z,{label:"Select owned appliances:",placeholder:"",onSelectionChange:b,appliances:g})]})]})},W=()=>{const[a,r]=m({seed:"az",day:1});return e($,{children:[e("div",{children:"Hover over a cell for instructions on how to get those blueprints. Getting the blueprints in grey requires taking extra blueprints out of cabinets"}),e(j,{onConfigChange:r}),e(_,{...a,blueprintCabinets:1}),!1,e(E,{})]})};O(e(W,{}),document.getElementById("app"));
