import{u as e,q as O,g as $}from"./jsxRuntime.module-wfZfYPmn.js";import"./compat.module-qsrks2fs.js";import{A as P,S as K,G as L}from"./GhostBlueprints-tEGkeiHO.js";import{h as m,F as V,p as E}from"./unlocks-Gx_wR1Yr.js";import{u as D,a as S,U as M}from"./UnlockSelect-8NUdvTgn.js";import"./prng-1rWzft78.js";const B=l=>{const[o,a]=m(l);return[o,n=>{a(n.target.value)}]},U=[...P];function F(l,o,a){const i=o.toLowerCase();return U.filter(function(c){return!l.some(p=>p.ID===c.ID)&&c.Name.toLowerCase().includes(i)&&(!a||c.StapleWhenMissing)})}function H({onSelectionChange:l,label:o,placeholder:a,include:i=!0,appliances:n=[],stapleRelatedOnly:c=!0}){const[p,f]=m(""),C=V(()=>F(n,p,c),[n,p]),{getSelectedItemProps:v,getDropdownProps:N,removeSelectedItem:w}=D({selectedItems:n,onStateChange({selectedItems:r,type:s}){switch(s){case D.stateChangeTypes.SelectedItemKeyDownBackspace:case D.stateChangeTypes.SelectedItemKeyDownDelete:case D.stateChangeTypes.DropdownKeyDownBackspace:case D.stateChangeTypes.FunctionRemoveSelectedItem:l(r??[]);break}}}),{isOpen:u,getToggleButtonProps:g,getLabelProps:y,getMenuProps:b,getInputProps:h,highlightedIndex:k,getItemProps:t,selectedItem:I}=S({items:C,itemToString(r){return r?r.Name:""},defaultHighlightedIndex:0,selectedItem:null,inputValue:p,stateReducer(r,s){const{changes:d,type:T}=s;switch(T){case S.stateChangeTypes.InputKeyDownEnter:case S.stateChangeTypes.ItemClick:return{...d,isOpen:!0,highlightedIndex:0};default:return d}},onStateChange({inputValue:r,type:s,selectedItem:d}){switch(s){case S.stateChangeTypes.InputKeyDownEnter:case S.stateChangeTypes.ItemClick:case S.stateChangeTypes.InputBlur:d&&(l([...n,d]),f(""));break;case S.stateChangeTypes.InputChange:f(r??"");break}}});return e("div",{className:"combo-container",children:[e("div",{className:"",children:[e("label",{className:"",...y(),children:o??"Select desired cards"}),e("div",{className:"",children:[n.map(function(s,d){return e("span",{className:"selected-items"+(i?" include":" exclude"),...v({selectedItem:s,index:d}),children:[s.Name,e("span",{class:"x",onClick:T=>{T.stopPropagation(),w(s)},children:"âœ•"})]},`selected-item-${d}`)}),e("div",{className:"",children:e("input",{placeholder:a??"Card Selection(s)",className:"",...h(N({preventKeyAction:u}))})})]})]}),e("ul",{className:`dropdown ${u&&C.length?"":"hidden"}`,...b(),children:[!1,u&&C.map((r,s)=>e("li",{className:j(k===s&&"bg-blue-300",I===r&&"font-bold","py-2 px-3 shadow-sm flex flex-col"),...t({item:r,index:s}),children:e("span",{children:r.Name})},`${r.ID}${s}`))]})]})}const j=(...l)=>l.filter(o=>o).join(" ");function q(l){let o="";if(!l.length)return"Spawn: any settings";for(let a=0;a<l.length;a++){const i=l[a];let n=a?`Reroll ${a}`:"Spawn";n+=": ",n+="Blueprints "+(i.spawnInside?"Spawn Inside":"Spawn Outside, "+(i.playerInside?"Someone Inside":"All Players Stand Outside")),a&&(n+=`, reroll ${l[a].blueprintCount} blueprints`),o+=n+`
`}return o+=`Reroll ${l.length}: any settings`,o}const z=({seed:l,day:o,startingConfig:a=[],baseUpgradeChance:i=0,blueprintCount:n=5,searchDepth:c=2,ghostBlueprints:p=2,blueprintCabinets:f=1,solo:C,cards:v=[],appliances:N=[]})=>{var k;l=l.toLocaleLowerCase();const w={blueprintCount:n+p,spawnInside:!0},u=new K(l,i);for(const t of v)u.addCard(t);u.OwnedAppliances=[...u.OwnedAppliances,...N];const g=[],y=[];for(let t=-f-1;t<=f;t++){const I={spawnInside:!0,blueprintCount:n+t};g.push(I),C||g.push({spawnInside:!1,playerInside:!0,blueprintCount:n+t}),g.push({spawnInside:!1,playerInside:!1,blueprintCount:n+t}),t===0&&(y.push(I),y.push({spawnInside:!1,playerInside:!0,blueprintCount:n+t}),y.push({spawnInside:!1,playerInside:!1,blueprintCount:n+t}))}let b=[],h=[a];for(let t=0;t<=c;t++){let I=[],r=[];for(let s=0;s<h.length;s++){const d={...w};d.blueprintCount=h[s].length?(((k=h[s].at(-1))==null?void 0:k.blueprintCount)??n)+p:n;const T=u.getAppliances([...h[s],d],o).map(x=>x.Name);r.push(e("td",{colspan:g.length**(c-t),title:q(h[s]),children:e(L,{bps:T,ghostCount:t===0?0:p})}));const R=a.length+t===0?y:g;for(const x of R){const A=[...h[s],x];I.push(A)}}b.push(e("tr",{children:[e("td",{children:t?`Reroll ${t}`:"Spawns"}),r]})),h=I}return e("table",{children:[" ",b," "]})},G=({onConfigChange:l})=>{const[o,a]=m(2),[i,n]=B("az"),[c,p]=B("2"),[f,C]=m(5),[v,N]=m(0),[w,u]=m(!1),[g,y]=m([P.filter(t=>t.Name==="Blueprint Cabinet")[0]]),[b,h]=m([]),k=t=>{t.target.checked?(C(7),N(.25)):(C(5),N(0))};return E(()=>{l({seed:i,day:Number(c)-1,initialRerollConfig:[],blueprintCount:f,baseUpgradeChance:v,solo:w,appliances:g,cards:b,searchDepth:o})},[i,c,f,v,w,g,b,o]),e("div",{children:[e("div",{children:[e("div",{children:"Run Config:"}),e("label",{for:"solo",children:"Solo:"}),e("input",{type:"checkbox",checked:w,onChange:()=>u(t=>!t)}),e("label",{for:"searchDepth",children:"Number of Rerolls"})," ",e("input",{id:"searchDepth",type:"number",value:o,onChange:t=>a(Number(t.target.value))}),e("br",{}),e("label",{for:"seed",value:i,children:["Seed:"," "]}),e("input",{type:"text",value:i,onChange:n}),e("label",{for:"setting",children:"Turbo?"}),e("input",{id:"setting",type:"checkbox",checked:f===7,onChange:k})]}),e("div",{children:[e("label",{for:"day",value:c,children:["Prep of Day:"," "]}),e("input",{type:"number",value:c,onChange:p}),e(M,{label:"Selected cards:",onSelectionChange:t=>{h(t.cards)},showSelectionMode:!1,cards:b,include:!0}),e(H,{label:"Select owned appliances:",placeholder:"",onSelectionChange:y,appliances:g})]})]})},_=()=>{const[l,o]=m({seed:"az",day:1});return e($,{children:[e(G,{onConfigChange:o}),e(z,{...l,blueprintCabinets:1}),e("h3",{children:"How to use this tool:"}),e("ul",{children:[e("li",{children:"Find a cell in the table with the appliance you're looking for. The first row is the natural spawns. Each row down you go will require another reroll"}),e("li",{children:"Hover the cell to find instructions on how many blueprints you need to reroll, what blueprint spawn settings you need to have, and where you need to stand at each step to reach that cell. They will always tell you that the settings and number of blueprints on the last reroll can be anything"}),e("li",{children:"If you reroll 5 blueprints on the last step, you will see the first 5 blueprints in that cell, read left to right. The blueprints in normal text are the ones you would see if you rerolled all blueprints from the previous step. The greyed out blueprints are those you would see only if you take blueprints out of cabinets just before the final reroll"})]}),e("div",{children:"Not implemented: handling blueprint desk effects on rerolls"})]})};O(e(_,{}),document.getElementById("app"));
